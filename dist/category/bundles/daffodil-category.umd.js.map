{"version":3,"file":"daffodil-category.umd.js","sources":["../../../node_modules/tslib/tslib.es6.js","ng://@daffodil/category/actions/category.actions.ts","ng://@daffodil/category/models/category-filter-base.ts","ng://@daffodil/category/reducers/category/toggle-filter/util.ts","ng://@daffodil/category/reducers/category/toggle-filter/equal.ts","ng://@daffodil/category/reducers/category/toggle-filter/range.ts","ng://@daffodil/category/reducers/category/toggle-filter/match.ts","ng://@daffodil/category/reducers/category/toggle-filter/core.ts","ng://@daffodil/category/reducers/category/category.reducer.ts","ng://@daffodil/category/reducers/category-entities/category-entities-adapter.ts","ng://@daffodil/category/reducers/category-entities/category-entities.reducer.ts","ng://@daffodil/category/reducers/category-reducers.ts","ng://@daffodil/category/drivers/injection-tokens/category-driver.token.ts","ng://@daffodil/category/models/requests/filter-request.ts","ng://@daffodil/category/helpers/validate-filters.ts","ng://@daffodil/category/effects/category.effects.ts","ng://@daffodil/category/resolvers/category-page/default-category-page-size.token.ts","ng://@daffodil/category/resolvers/category-page/category-page.resolver.ts","ng://@daffodil/category/selectors/category-feature.selector.ts","ng://@daffodil/category/selectors/applied-filter/applied-filter-methods.ts","ng://@daffodil/category/selectors/category-page/category-page.selector.ts","ng://@daffodil/category/selectors/category-entities/category-entities.selector.ts","ng://@daffodil/category/selectors/category.selector.ts","ng://@daffodil/category/effects/category-page.effects.ts","ng://@daffodil/category/category-state.module.ts","ng://@daffodil/category/category.module.ts","ng://@daffodil/category/facades/category.facade.ts","ng://@daffodil/category/drivers/magento/queries/get-category.ts","ng://@daffodil/category/drivers/magento/queries/get-products.ts","ng://@daffodil/category/drivers/magento/models/requests/filters.ts","ng://@daffodil/category/drivers/magento/transformers/applied-filter-transformer.service.ts","ng://@daffodil/category/drivers/magento/models/requests/sort.ts","ng://@daffodil/category/models/requests/category-request.ts","ng://@daffodil/category/drivers/magento/transformers/applied-sort-option-transformer.service.ts","ng://@daffodil/category/drivers/magento/transformers/pure/sort-default-option-first.ts","ng://@daffodil/category/drivers/magento/transformers/category-page-config-transformer.service.ts","ng://@daffodil/category/drivers/magento/transformers/category-transformer.service.ts","ng://@daffodil/category/drivers/magento/transformers/category-response-transform.service.ts","ng://@daffodil/category/drivers/magento/queries/get-category-aggregations.ts","ng://@daffodil/category/drivers/magento/queries/custom-attribute-metadata.ts","ng://@daffodil/category/drivers/magento/transformers/custom-metadata-attributes-methods.ts","ng://@daffodil/category/drivers/magento/category.service.ts","ng://@daffodil/category/drivers/magento/category-driver.module.ts","ng://@daffodil/category/models/category-applied-filter.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { Action } from '@ngrx/store';\n\nimport { DaffProduct } from '@daffodil/product';\n\nimport { DaffGetCategoryResponse } from '../models/get-category-response';\nimport { DaffCategoryRequest } from '../models/requests/category-request';\nimport { DaffCategoryFilterRequest, DaffToggleCategoryFilterRequest } from '../models/requests/filter-request';\nimport { DaffCategoryPageConfigurationState } from '../models/category-page-configuration-state';\nimport { DaffGenericCategory } from '../models/generic-category';\nimport { DaffCategory } from '../models/category';\n\nexport enum DaffCategoryActionTypes {\n  CategoryLoadAction = '[Daff-Category] Category Load Action',\n  CategoryLoadSuccessAction = '[Daff-Category] Category Load Success Action',\n  CategoryLoadFailureAction = '[Daff-Category] Category Load Failure Action',\n  CategoryPageLoadAction = '[Daff-Category] Category Page Load Action',\n  CategoryPageLoadSuccessAction = '[Daff-Category] Category Page Load Success Action',\n  CategoryPageLoadFailureAction = '[Daff-Category] Category Page Load Failure Action',\n  ChangeCategoryPageSizeAction = '[Daff-Category] Change Category Page Size Action',\n  ChangeCategoryCurrentPageAction = '[Daff-Category] Change Category Current Page Action',\n  ChangeCategorySortingOptionAction = '[Daff-Category] Change Category Sorting Option Action',\n\tChangeCategoryFiltersAction = '[Daff-Category] Change Category Filters Action',\n\tToggleCategoryFilterAction = '[Daff-Category] Toggle Category Filter Action'\n}\n\n/**\n * An action triggered to initialize a category load request.\n *\n * @param request - DaffCategoryRequest object\n */\nexport class DaffCategoryLoad<T extends DaffCategoryRequest = DaffCategoryRequest> implements Action {\n  readonly type = DaffCategoryActionTypes.CategoryLoadAction;\n\n  constructor(public request: T) { }\n}\n\n/**\n * An action triggered upon a successful category request.\n *\n * @param response - DaffGetCategoryResponse object\n */\nexport class DaffCategoryLoadSuccess<\n\tT extends DaffCategoryRequest = DaffCategoryRequest,\n\tV extends DaffGenericCategory<V> = DaffCategory,\n\tU extends DaffCategoryPageConfigurationState<T> = DaffCategoryPageConfigurationState<T>,\n\tW extends DaffProduct = DaffProduct\n> implements Action {\n  readonly type = DaffCategoryActionTypes.CategoryLoadSuccessAction;\n\n  constructor(public response: DaffGetCategoryResponse<T, V, U, W>) { }\n}\n\n/**\n * An action triggered upon a failed category request.\n *\n * @param errorMessage - an error message\n */\nexport class DaffCategoryLoadFailure implements Action {\n  readonly type = DaffCategoryActionTypes.CategoryLoadFailureAction;\n\n  constructor(public errorMessage: string) { }\n}\n\n/**\n * An action triggered to initialize a category page load request.\n * This is intended to be used for loading full category pages.\n *\n * @param request - DaffCategoryRequest object\n */\nexport class DaffCategoryPageLoad<T extends DaffCategoryRequest = DaffCategoryRequest> implements Action {\n  readonly type = DaffCategoryActionTypes.CategoryPageLoadAction;\n\n  constructor(public request: T) { }\n}\n\n/**\n * An action triggered upon a successful category page request.\n *\n * @param response - DaffGetCategoryResponse object\n */\nexport class DaffCategoryPageLoadSuccess<\n\tT extends DaffCategoryRequest = DaffCategoryRequest,\n\tV extends DaffGenericCategory<V> = DaffCategory,\n\tU extends DaffCategoryPageConfigurationState<T> = DaffCategoryPageConfigurationState<T>,\n\tW extends DaffProduct = DaffProduct\n> implements Action {\n  readonly type = DaffCategoryActionTypes.CategoryPageLoadSuccessAction;\n\n  constructor(public response: DaffGetCategoryResponse<T, V, U, W>) { }\n}\n\n/**\n * An action triggered upon a failed category page request.\n *\n * @param errorMessage - an error message\n */\nexport class DaffCategoryPageLoadFailure implements Action {\n  readonly type = DaffCategoryActionTypes.CategoryPageLoadFailureAction;\n\n  constructor(public errorMessage: string) { }\n}\n\n/**\n * An action for changing the number of products shown on each page for the selected category.\n *\n * @param pageSize - The number of products per page.\n */\nexport class DaffChangeCategoryPageSize implements Action {\n  readonly type = DaffCategoryActionTypes.ChangeCategoryPageSizeAction;\n\n  constructor(public pageSize: number) { }\n}\n\n/**\n * An action for changing the current page of products for the selected category.\n *\n * @param currentPage - The current page of products for the selected category.\n */\nexport class DaffChangeCategoryCurrentPage implements Action {\n  readonly type = DaffCategoryActionTypes.ChangeCategoryCurrentPageAction;\n\n  constructor(public currentPage: number) { }\n}\n\n/**\n * An action for changing the sorting option for the selected category.\n *\n * @param sort - The sort option to be applied.\n */\nexport class DaffChangeCategorySortingOption implements Action {\n  readonly type = DaffCategoryActionTypes.ChangeCategorySortingOptionAction;\n\n  constructor(\n\t\tpublic sort: {\n\t\t\toption: DaffCategoryRequest['applied_sort_option'],\n\t\t\tdirection: DaffCategoryRequest['applied_sort_direction']\n\t\t}\n\t) { }\n}\n\n/**\n * An action for changing the filters for the selected category.\n *\n * @param filters - Filters to be applied to the selected category.\n */\nexport class DaffChangeCategoryFilters implements Action {\n  readonly type = DaffCategoryActionTypes.ChangeCategoryFiltersAction;\n\n  constructor(public filters: DaffCategoryFilterRequest[]) { }\n}\n\n/**\n * An action for toggling a filters for the selected category.\n *\n * @param filter - Filter to be toggle on the selected category.\n */\nexport class DaffToggleCategoryFilter implements Action {\n  readonly type = DaffCategoryActionTypes.ToggleCategoryFilterAction;\n\n  constructor(public filter: DaffToggleCategoryFilterRequest) { }\n}\n\nexport type DaffCategoryActions<\n\tT extends DaffCategoryRequest = DaffCategoryRequest,\n\tU extends DaffGenericCategory<U> = DaffCategory,\n\tV extends DaffCategoryPageConfigurationState<T> = DaffCategoryPageConfigurationState<T>,\n\tW extends DaffProduct = DaffProduct\n> =\n  | DaffCategoryLoad<T>\n  | DaffCategoryLoadSuccess<T, U, V, W>\n  | DaffCategoryLoadFailure\n  | DaffCategoryPageLoad<T>\n  | DaffCategoryPageLoadSuccess<T, U, V, W>\n  | DaffCategoryPageLoadFailure\n\t| DaffChangeCategoryPageSize\n\t| DaffChangeCategoryCurrentPage\n  | DaffChangeCategorySortingOption\n  | DaffChangeCategoryFilters\n  | DaffToggleCategoryFilter;\n","export enum DaffCategoryFilterType {\n\tMatch = 'match',\n\tEqual = 'equal',\n\tRange = 'range'\n}\n\nexport interface DaffCategoryFilterBase {\n\tlabel: string;\n\tname: string;\n\ttype: DaffCategoryFilterType;\n}\n","import { DaffToggleCategoryFilterRequest, DaffCategoryFilterRequest, DaffCategoryFilterEqualRequest } from '../../../models/requests/filter-request';\n\nexport function getAppliedFilterByName(name: string, appliedFilters: DaffCategoryFilterRequest[]): DaffCategoryFilterRequest {\n\treturn appliedFilters.filter(filter => filter.name === name).shift();\n}\n\nexport function toggledFilterNameExists(toggledFilter: DaffToggleCategoryFilterRequest, appliedFilters: DaffCategoryFilterRequest[]): boolean {\n\treturn appliedFilters && !!appliedFilters.find(filter => filter.name === toggledFilter.name)\n}\n\nexport function addToExistingFilter(toggledFilter: DaffToggleCategoryFilterRequest, appliedFilters: DaffCategoryFilterRequest[])\n: DaffCategoryFilterRequest[] {\n\treturn appliedFilters.map(filter => {\n\t\tif(filter.name === toggledFilter.name) {\n\t\t\t(<DaffCategoryFilterEqualRequest>filter).value.push(toggledFilter.value)\n\t\t}\n\n\t\treturn filter;\n\t});\n}\n","import { DaffToggleCategoryFilterEqualRequest, DaffCategoryFilterRequest, DaffCategoryFilterEqualRequest } from '../../../models/requests/filter-request';\nimport { getAppliedFilterByName, toggledFilterNameExists, addToExistingFilter } from './util';\nimport { DaffCategoryFilterType } from '../../../models/category-filter-base';\n\nexport function isEqualFilterApplied(toggledFilter: DaffToggleCategoryFilterEqualRequest, appliedFilters: DaffCategoryFilterRequest[]): boolean {\n\tconst filterMatchingName = <DaffCategoryFilterEqualRequest>getAppliedFilterByName(toggledFilter.name, appliedFilters);\n\tif(filterMatchingName) {\n\t\treturn !!filterMatchingName.value.filter(filterValue => filterValue === toggledFilter.value).length;\n\t} else return false;\n}\n\nexport function removeEqualFilter(toggledFilter: DaffToggleCategoryFilterEqualRequest, appliedFilters: DaffCategoryFilterRequest[]): DaffCategoryFilterRequest[] {\n\treturn appliedFilters.map(appliedFilter => {\n\t\tif(appliedFilter.name === toggledFilter.name) {\n\t\t\tappliedFilter.value = (<DaffCategoryFilterEqualRequest>appliedFilter).value.filter(value => value !== toggledFilter.value);\n\t\t}\n\t\treturn appliedFilter;\n\t}).filter(filter => filter.type === DaffCategoryFilterType.Match || filter.value.length !== 0)\n}\n\nexport function addEqualFilter(toggledFilter: DaffToggleCategoryFilterEqualRequest, appliedFilters: DaffCategoryFilterRequest[])\n: DaffCategoryFilterRequest[] {\n\treturn toggledFilterNameExists(toggledFilter, appliedFilters) ?\n\t\taddToExistingFilter(toggledFilter, appliedFilters) :\n\t\taddNewEqualFilter(toggledFilter, appliedFilters);\n}\n\nexport function addNewEqualFilter(toggledFilter: DaffToggleCategoryFilterEqualRequest, appliedFilters: DaffCategoryFilterRequest[])\n: DaffCategoryFilterRequest[] {\n\treturn appliedFilters.concat([{\n\t\tname: toggledFilter.name,\n\t\tvalue: [toggledFilter.value],\n\t\ttype: DaffCategoryFilterType.Equal\n\t}]);\n}\n","import { DaffToggleCategoryFilterRangeRequest, DaffCategoryFilterRequest, DaffCategoryFilterRangeRequest } from '../../../models/requests/filter-request';\nimport { getAppliedFilterByName, toggledFilterNameExists, addToExistingFilter } from './util';\nimport { DaffCategoryFilterType } from '../../../models/category-filter-base';\n\nexport function isRangeFilterApplied(toggledFilter: DaffToggleCategoryFilterRangeRequest, appliedFilters: DaffCategoryFilterRequest[]): boolean {\n\tconst filterMatchingName = <DaffCategoryFilterRangeRequest>getAppliedFilterByName(toggledFilter.name, appliedFilters);\n\tif(filterMatchingName) {\n\t\treturn !!filterMatchingName.value.filter(filterValue => filterValue === toggledFilter.value).length;\n\t} else return false;\n}\n\nexport function removeRangeFilter(toggledFilter: DaffToggleCategoryFilterRangeRequest, appliedFilters: DaffCategoryFilterRequest[]): DaffCategoryFilterRequest[] {\n\treturn appliedFilters.map(appliedFilter => {\n\t\tif(appliedFilter.name === toggledFilter.name) {\n\t\t\tappliedFilter.value = (<DaffCategoryFilterRangeRequest>appliedFilter).value.filter(value => value !== toggledFilter.value);\n\t\t}\n\t\treturn appliedFilter;\n\t}).filter(filter => filter.type === DaffCategoryFilterType.Match || filter.value.length !== 0)\n}\n\nexport function addRangeFilter(toggledFilter: DaffToggleCategoryFilterRangeRequest, appliedFilters: DaffCategoryFilterRequest[])\n: DaffCategoryFilterRequest[] {\n\treturn toggledFilterNameExists(toggledFilter, appliedFilters) ?\n\t\taddToExistingFilter(toggledFilter, appliedFilters) :\n\t\taddNewRangeFilter(toggledFilter, appliedFilters);\n}\n\nexport function addNewRangeFilter(toggledFilter: DaffToggleCategoryFilterRangeRequest, appliedFilters: DaffCategoryFilterRequest[])\n: DaffCategoryFilterRequest[] {\n\treturn appliedFilters.concat([{\n\t\tname: toggledFilter.name,\n\t\tvalue: [toggledFilter.value],\n\t\ttype: DaffCategoryFilterType.Range\n\t}]);\n}\n","import { DaffToggleCategoryFilterMatchRequest, DaffCategoryFilterRequest } from '../../../models/requests/filter-request';\nimport { DaffCategoryFilterType } from '../../../models/category-filter-base';\nimport { getAppliedFilterByName } from './util';\n\nexport function isMatchFilterApplied(toggledFilter: DaffToggleCategoryFilterMatchRequest, appliedFilters: DaffCategoryFilterRequest[]): boolean {\n\treturn !!getAppliedFilterByName(toggledFilter.name, appliedFilters);\n}\n\nexport function removeMatchFilter(filterName: DaffToggleCategoryFilterMatchRequest, appliedFilters: DaffCategoryFilterRequest[]): DaffCategoryFilterRequest[] {\n\treturn appliedFilters.filter(filter => filter.name !== filterName.name)\n}\n\nexport function addMatchFilter(toggledFilter: DaffToggleCategoryFilterMatchRequest, appliedFilters: DaffCategoryFilterRequest[])\n: DaffCategoryFilterRequest[] {\n\treturn appliedFilters.concat([{\n\t\tname: toggledFilter.name,\n\t\tvalue: toggledFilter.value,\n\t\ttype: DaffCategoryFilterType.Match\n\t}]);\n}\n","import { DaffToggleCategoryFilterRequest, DaffCategoryFilterRequest } from '../../../models/requests/filter-request';\nimport { DaffCategoryFilterType } from '../../../models/category-filter-base';\nimport { isEqualFilterApplied, removeEqualFilter, addEqualFilter } from './equal';\nimport { isRangeFilterApplied, removeRangeFilter, addRangeFilter } from './range';\nimport { isMatchFilterApplied, removeMatchFilter, addMatchFilter } from './match';\n\nexport function toggleCategoryFilter(\n\ttoggledFilter: DaffToggleCategoryFilterRequest, \n\tappliedFilters: DaffCategoryFilterRequest[]\n): DaffCategoryFilterRequest[] {\n\treturn isFilterApplied(toggledFilter, appliedFilters)\n\t\t? removeFilter(toggledFilter, appliedFilters)\n\t\t: addFilter(toggledFilter, appliedFilters)\n}\n\nexport function isFilterApplied(toggledFilter: DaffToggleCategoryFilterRequest, appliedFilters: DaffCategoryFilterRequest[]): boolean {\n\tswitch(toggledFilter.type) {\n\t\tcase(DaffCategoryFilterType.Equal) :\n\t\t\treturn isEqualFilterApplied(toggledFilter, appliedFilters);\n\t\tcase(DaffCategoryFilterType.Range) :\n\t\t\treturn isRangeFilterApplied(toggledFilter, appliedFilters);\n\t\tdefault :\n\t\t\treturn isMatchFilterApplied(toggledFilter, appliedFilters);\n\t}\n}\n\nexport function removeFilter(toggledFilter: DaffToggleCategoryFilterRequest, appliedFilters: DaffCategoryFilterRequest[])\n\t: DaffCategoryFilterRequest[] {\n\tswitch(toggledFilter.type) {\n\t\tcase(DaffCategoryFilterType.Equal) :\n\t\t\treturn removeEqualFilter(toggledFilter, appliedFilters);\n\t\tcase(DaffCategoryFilterType.Range) :\n\t\t\treturn removeRangeFilter(toggledFilter, appliedFilters);\n\t\tdefault :\n\t\t\treturn removeMatchFilter(toggledFilter, appliedFilters);\n\t}\n}\n\nexport function addFilter(toggledFilter: DaffToggleCategoryFilterRequest, appliedFilters: DaffCategoryFilterRequest[])\n\t: DaffCategoryFilterRequest[] {\n\tswitch(toggledFilter.type) {\n\t\tcase(DaffCategoryFilterType.Equal) :\n\t\t\treturn addEqualFilter(toggledFilter, appliedFilters);\n\t\tcase(DaffCategoryFilterType.Range) :\n\t\t\treturn addRangeFilter(toggledFilter, appliedFilters);\n\t\tdefault :\n\t\t\treturn addMatchFilter(toggledFilter, appliedFilters);\n\t}\n}\n","import { DaffProduct } from '@daffodil/product';\n\nimport { DaffCategoryActionTypes, DaffCategoryActions } from '../../actions/category.actions';\nimport { DaffCategoryReducerState } from './category-reducer-state.interface';\nimport { toggleCategoryFilter } from './toggle-filter/core';\nimport { DaffCategoryRequest } from '../../models/requests/category-request';\nimport { DaffCategoryPageConfigurationState } from '../../models/category-page-configuration-state';\nimport { DaffGenericCategory } from '../../models/generic-category';\n\nconst initialState: DaffCategoryReducerState<any, any> = {\n\tcategoryPageConfigurationState: {\n    id: null,\n\t\tfilter_requests: [],\n    applied_sort_option: null,\n    applied_sort_direction: null,\n    current_page: null,\n    page_size: null,\n    total_pages: null,\n    filters: [],\n\t\tsort_options: [],\n\t\ttotal_products: null,\n\t\tproduct_ids: []\n\t},\n\tcategoryLoading: false,\n\tproductsLoading: false,\n  errors: []\n};\n\nexport function daffCategoryReducer<T extends DaffCategoryRequest, U extends DaffGenericCategory<U>, V extends DaffCategoryPageConfigurationState<T>, W extends DaffProduct>\n\t(state = initialState, action: DaffCategoryActions<T, U, V, W>): DaffCategoryReducerState<T, V> {\n  switch (action.type) {\n    case DaffCategoryActionTypes.CategoryLoadAction:\n      return {\n        ...state,\n\t\t\t\tcategoryLoading: true,\n\t\t\t\tproductsLoading: true,\n      };\n\n    // This reducer must assume the call will be successful, and immediately set the applied filters to state, because the\n    // GetCategory magento call doesn't return currently applied filters. If there is a bug where the wrong filters are somehow\n    // applied by Magento, then this will result in a bug. Until Magento returns applied filters with a category call, this is\n    // unavoidable.\n    case DaffCategoryActionTypes.CategoryPageLoadAction:\n      return {\n        ...state,\n\t\t\t\tcategoryLoading: true,\n\t\t\t\tproductsLoading: true,\n        categoryPageConfigurationState: {\n          ...state.categoryPageConfigurationState,\n          ...action.request\n\t\t\t\t}\n\t\t\t};\n\t\tcase DaffCategoryActionTypes.ChangeCategoryPageSizeAction:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tproductsLoading: true,\n\t\t\t\tcategoryPageConfigurationState: {\n\t\t\t\t\t...state.categoryPageConfigurationState,\n\t\t\t\t\tpage_size: action.pageSize\n\t\t\t\t}\n\t\t\t};\n\t\tcase DaffCategoryActionTypes.ChangeCategoryCurrentPageAction:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tproductsLoading: true,\n\t\t\t\tcategoryPageConfigurationState: {\n\t\t\t\t\t...state.categoryPageConfigurationState,\n\t\t\t\t\tcurrent_page: action.currentPage\n\t\t\t\t}\n\t\t\t};\n\t\tcase DaffCategoryActionTypes.ChangeCategorySortingOptionAction:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tproductsLoading: true,\n\t\t\t\tcategoryPageConfigurationState: {\n\t\t\t\t\t...state.categoryPageConfigurationState,\n\t\t\t\t\tapplied_sort_option: action.sort.option,\n\t\t\t\t\tapplied_sort_direction: action.sort.direction\n\t\t\t\t}\n\t\t\t};\n\t\tcase DaffCategoryActionTypes.ChangeCategoryFiltersAction:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tproductsLoading: true,\n\t\t\t\tcategoryPageConfigurationState: {\n\t\t\t\t\t...state.categoryPageConfigurationState,\n\t\t\t\t\tfilter_requests: action.filters\n\t\t\t\t}\n\t\t\t};\n\t\tcase DaffCategoryActionTypes.ToggleCategoryFilterAction:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tproductsLoading: true,\n\t\t\t\tcategoryPageConfigurationState: {\n\t\t\t\t\t...state.categoryPageConfigurationState,\n\t\t\t\t\tfilter_requests: toggleCategoryFilter(action.filter, state.categoryPageConfigurationState.filter_requests)\n\t\t\t\t}\n\t\t\t}\n    // This reducer cannot spread over state, because this would wipe out the applied filters on state. Applied filters are not\n    // set here for reasons stated above.\n\t\tcase DaffCategoryActionTypes.CategoryLoadSuccessAction:\n\t\tcase DaffCategoryActionTypes.CategoryPageLoadSuccessAction:\n      return {\n        ...state,\n\t\t\t\tcategoryLoading: false,\n\t\t\t\tproductsLoading: false,\n        categoryPageConfigurationState: {\n          ...state.categoryPageConfigurationState,\n          id: action.response.categoryPageConfigurationState.id,\n          current_page: action.response.categoryPageConfigurationState.current_page,\n          page_size: action.response.categoryPageConfigurationState.page_size,\n          filters: action.response.categoryPageConfigurationState.filters,\n          sort_options: action.response.categoryPageConfigurationState.sort_options,\n\t\t\t\t\ttotal_pages: action.response.categoryPageConfigurationState.total_pages,\n\t\t\t\t\ttotal_products: action.response.categoryPageConfigurationState.total_products,\n\t\t\t\t\tproduct_ids: action.response.categoryPageConfigurationState.product_ids\n        }\n      };\n    case DaffCategoryActionTypes.CategoryLoadFailureAction:\n    case DaffCategoryActionTypes.CategoryPageLoadFailureAction:\n      return {\n        ...state,\n\t\t\t\tcategoryLoading: false,\n\t\t\t\tproductsLoading: false,\n        errors: [action.errorMessage]\n      };\n    default:\n      return state;\n  }\n}\n","import { EntityAdapter, createEntityAdapter } from '@ngrx/entity';\nimport { DaffGenericCategory } from '../../models/generic-category';\nimport { DaffCategory } from '../../models/category';\n\nexport function daffCategoryEntitiesAdapter<T extends DaffGenericCategory<T> = DaffCategory>(): EntityAdapter<T> {\n\treturn createEntityAdapter<T>();\n} ","import { EntityState } from '@ngrx/entity';\n\nimport { DaffProduct } from '@daffodil/product';\n\nimport { daffCategoryEntitiesAdapter } from './category-entities-adapter';\nimport { DaffCategoryActionTypes, DaffCategoryActions } from '../../actions/category.actions';\nimport { DaffCategoryRequest } from '../../models/requests/category-request';\nimport { DaffCategoryPageConfigurationState } from '../../models/category-page-configuration-state';\nimport { DaffGenericCategory } from '../../models/generic-category';\nimport { DaffCategory } from '../../models/category';\n\nexport function daffCategoryEntitiesReducer<\n\tT extends DaffCategoryRequest = DaffCategoryRequest,\n\tV extends DaffGenericCategory<V> = DaffCategory,\n\tU extends DaffCategoryPageConfigurationState<T> = DaffCategoryPageConfigurationState<T>,\n\tW extends DaffProduct = DaffProduct\n>(\n  state = daffCategoryEntitiesAdapter<V>().getInitialState(),\n\taction: DaffCategoryActions<T, V, U, W>\n): EntityState<V> {\n  switch (action.type) {\n    case DaffCategoryActionTypes.CategoryLoadSuccessAction:\n    case DaffCategoryActionTypes.CategoryPageLoadSuccessAction:\n      return daffCategoryEntitiesAdapter<V>().upsertOne(\n        {\n          id: action.response.category.id,\n          ...action.response.category\n        },\n        state\n      );\n    default:\n      return state;\n  }\n}\n","import { daffCategoryReducer } from './category/category.reducer';\nimport { daffCategoryEntitiesReducer } from './category-entities/category-entities.reducer';\n\nexport const daffCategoryReducers = {\n\tcategory: daffCategoryReducer,\n\tcategoryEntities: daffCategoryEntitiesReducer\n};\n","import { InjectionToken } from '@angular/core';\n\nexport const DaffCategoryDriver = new InjectionToken('DaffCategoryDriver');\n","import { DaffCategoryFilterType } from '../category-filter-base';\n\n/**\n * The separator between a range type filter's values\n * e.g. \"price\": \"30-40\"\n */\nexport const DaffCategoryFromToFilterSeparator = '-';\n\nexport interface DaffToggleCategoryFilterMatchRequest {\n\ttype: DaffCategoryFilterType.Match;\n\tname: string;\n\tvalue: string;\n}\n\nexport interface DaffToggleCategoryFilterEqualRequest {\n\ttype: DaffCategoryFilterType.Equal;\n\tname: string;\n\tvalue: string;\n}\n\nexport interface DaffToggleCategoryFilterRangeRequest {\n\ttype: DaffCategoryFilterType.Range;\n\tname: string;\n\tvalue: string;\n}\n\nexport interface DaffCategoryFilterEqualRequest {\n\ttype: DaffCategoryFilterType.Equal;\n\tname: string;\n\tvalue: string[];\n}\n\nexport interface DaffCategoryFilterMatchRequest {\n\ttype: DaffCategoryFilterType.Match;\n\tname: string;\n\tvalue: string;\n}\n\nexport interface DaffCategoryFilterRangeRequest {\n\ttype: DaffCategoryFilterType.Range;\n\tname: string;\n\tvalue: string[];\n}\n\nexport type DaffToggleCategoryFilterRequest =\n\tDaffToggleCategoryFilterMatchRequest |\n\tDaffToggleCategoryFilterEqualRequest |\n\tDaffToggleCategoryFilterRangeRequest;\n\nexport type DaffCategoryFilterRequest =\n\tDaffCategoryFilterMatchRequest |\n\tDaffCategoryFilterEqualRequest |\n\tDaffCategoryFilterRangeRequest;\n","import { DaffCategoryFilterType } from '../models/category-filter-base';\nimport { DaffCategoryFilterRequest, DaffCategoryFromToFilterSeparator } from '../models/requests/filter-request';\n\nexport function daffCategoryValidateFilters(filters: DaffCategoryFilterRequest[]): void {\n  if(!filters) return;\n  filters.forEach((filter, i) => {\n    if(filter.type === DaffCategoryFilterType.Range &&\n      filter.value[0].split(DaffCategoryFromToFilterSeparator).length !== 2) {\n      throw new Error('Category range filter is in an invalid format. Should be **-**');\n    }\n\n    for(let j=i+1; j < filters.length; j++) {\n      if(filters[i].name === filters[j].name) {\n        throw new Error('More than one category filter of the same name exists. These should' +\n          ' be combined into a single filter action with multiple values.')\n      }\n    }\n  })\n}\n","import { Injectable, Inject } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { switchMap, catchError } from 'rxjs/operators';\nimport { of, Observable } from 'rxjs';\n\nimport { DaffProductGridLoadSuccess, DaffProduct } from '@daffodil/product';\n\nimport {\n  DaffCategoryActionTypes,\n  DaffCategoryLoad,\n  DaffCategoryLoadSuccess,\n  DaffCategoryLoadFailure,\n} from '../actions/category.actions';\nimport { DaffCategoryDriver } from '../drivers/injection-tokens/category-driver.token';\nimport { DaffCategoryServiceInterface } from '../drivers/interfaces/category-service.interface';\nimport { DaffGetCategoryResponse } from '../models/get-category-response';\nimport { DaffCategoryRequest } from '../models/requests/category-request';\nimport { DaffCategoryPageConfigurationState } from '../models/category-page-configuration-state';\nimport { DaffGenericCategory } from '../models/generic-category';\nimport { daffCategoryValidateFilters } from '../helpers/public_api';\n\n@Injectable()\nexport class DaffCategoryEffects<\n\tT extends DaffCategoryRequest,\n\tV extends DaffGenericCategory<V>,\n\tU extends DaffCategoryPageConfigurationState<T>,\n\tW extends DaffProduct\n> {\n\n  constructor(\n    private actions$: Actions,\n    @Inject(DaffCategoryDriver) private driver: DaffCategoryServiceInterface<T, V, U, W>,\n\t) {}\n\n  @Effect()\n  loadCategory$ : Observable<any> = this.actions$.pipe(\n    ofType(DaffCategoryActionTypes.CategoryLoadAction),\n    switchMap((action: DaffCategoryLoad<T>) => {\n\t\t\tdaffCategoryValidateFilters(action.request.filter_requests);\n      return this.driver.get(action.request).pipe(\n        switchMap((resp: DaffGetCategoryResponse<T, V, U, W>) => of(\n          new DaffProductGridLoadSuccess(resp.products),\n          new DaffCategoryLoadSuccess(resp)\n        )),\n        catchError(error => of(new DaffCategoryLoadFailure('Failed to load the category')))\n      )\n    })\n  )\n}\n","import { InjectionToken } from '@angular/core';\n\n/**\n * A token to define the default category page size on a category page load. This value is 12 by default.\n */\nexport const DaffDefaultCategoryPageSize = new InjectionToken<number>('DaffDefaultCategoryPageSize');\n","import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core'\nimport { ActivatedRouteSnapshot, Resolve } from '@angular/router'\nimport { ofType } from '@ngrx/effects';\nimport { ActionsSubject, Store } from '@ngrx/store';\nimport { Observable, of } from 'rxjs'\nimport { mapTo, take } from 'rxjs/operators';\n\nimport { DaffCategoryActionTypes, DaffCategoryPageLoad } from '../../actions/category.actions';\nimport { DaffCategoryReducersState } from '../../reducers/category-reducers.interface';\nimport { DaffDefaultCategoryPageSize } from './default-category-page-size.token';\n\n/**\n * Resolves category data for category pages, and will only resolve the url after a category request succeeds or fails. This resolver expects a url\n * of the form `some/url/{id}` where `{id}` is the category id.\n */\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class DaffCategoryPageResolver implements Resolve<Observable<boolean>> {\n  constructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\t@Inject(DaffDefaultCategoryPageSize) private defaultCategoryPageSize: number,\n    private store: Store<DaffCategoryReducersState>,\n    private dispatcher: ActionsSubject,\n\t) {}\n\t\n\tresolve(route: ActivatedRouteSnapshot): Observable<boolean> {\n\t\tthis.store.dispatch(new DaffCategoryPageLoad({\n      id: route.paramMap.get('id'), page_size: this.defaultCategoryPageSize\n\t\t}));\n\n\t\treturn isPlatformBrowser(this.platformId) ? of(true) : this.dispatcher.pipe(\n\t\t\tofType(DaffCategoryActionTypes.CategoryPageLoadSuccessAction, DaffCategoryActionTypes.CategoryPageLoadFailureAction),\n\t\t\tmapTo(true),\n\t\t\ttake(1)\n\t\t);\n\t}\n}\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\n\nimport { DaffGenericCategory } from '../models/generic-category';\nimport { DaffCategoryRequest } from '../models/requests/category-request';\nimport { DaffCategoryReducersState } from '../reducers/category-reducers.interface';\nimport { DaffCategoryPageConfigurationState } from '../models/category-page-configuration-state';\nimport { DaffCategory } from '../models/category';\n\nexport interface DaffCategoryFeatureMemoizedSelectors<\n\tT extends DaffCategoryRequest = DaffCategoryRequest, \n\tV extends DaffGenericCategory<V> = DaffCategory, \n\tU extends DaffCategoryPageConfigurationState<T> = DaffCategoryPageConfigurationState<T>\n> {\n\tselectCategoryFeatureState: MemoizedSelector<object, DaffCategoryReducersState<T, V, U>>;\n}\n\nexport const getDaffCategoryFeatureSelector = (() => {\n\tlet cache;\n\treturn <T extends DaffCategoryRequest, V extends DaffGenericCategory<V>, U extends DaffCategoryPageConfigurationState<T>>(): DaffCategoryFeatureMemoizedSelectors<T, V, U> => cache = cache \n\t\t? cache \n\t\t: { selectCategoryFeatureState: createFeatureSelector<DaffCategoryReducersState<T, V, U>>('category') };\n})();\n","import { DaffCategoryFilterOption, DaffCategoryFilter } from '../../models/category-filter';\nimport { DaffCategoryAppliedFilterOption, DaffCategoryAppliedFilter } from '../../models/category-applied-filter';\nimport { DaffCategoryFilterRangeRequest, DaffCategoryFilterMatchRequest, DaffCategoryFilterEqualRequest, DaffCategoryFilterRequest } from '../../models/requests/filter-request';\nimport { DaffCategoryFilterType } from '../../models/category-filter-base';\n\nexport function buildAppliedFilter(filter: DaffCategoryFilter, request: DaffCategoryFilterRequest): DaffCategoryAppliedFilter {\n\treturn {\n\t\tname: request.name,\n\t\ttype: request.type,\n\t\tlabel: filter.label,\n\t\toptions: buildAppliedFilterOptions(filter.options, request)\n\t}\n}\n\nfunction buildAppliedFilterOptions(filterOptions: DaffCategoryFilterOption[], filterRequest: DaffCategoryFilterRequest): DaffCategoryAppliedFilterOption[] {\n\tswitch(filterRequest.type) {\n\t\tcase(DaffCategoryFilterType.Equal) :\n\t\t\treturn buildAppliedFilterOptionsFromEqualRequest(filterOptions, filterRequest);\n\t\tcase(DaffCategoryFilterType.Range) :\n\t\t\treturn buildAppliedFilterOptionsFromRangeRequest(filterOptions, filterRequest);\n\t\tcase(DaffCategoryFilterType.Match) :\n\t\t\treturn buildAppliedFilterOptionsFromMatchRequest(filterOptions, filterRequest);\n\t}\n}\n\nfunction buildAppliedFilterOptionsFromEqualRequest(\n\tfilterOptions: DaffCategoryFilterOption[], filterRequest: DaffCategoryFilterEqualRequest\n): DaffCategoryAppliedFilterOption[] {\n\treturn filterOptions\n\t\t.filter(option => filterRequest.value.indexOf(option.value) > -1)\n\t\t.map(option => {\n\t\t\treturn {\n\t\t\t\tvalue: option.value,\n\t\t\t\tlabel: option.label\n\t\t\t}\n\t\t})\n}\n\nfunction buildAppliedFilterOptionsFromRangeRequest(\n\tfilterOptions: DaffCategoryFilterOption[], filterRequest: DaffCategoryFilterRangeRequest\n): DaffCategoryAppliedFilterOption[] {\n\treturn filterOptions\n\t.filter(option => filterRequest.value.indexOf(option.value) > -1)\n\t.map(option => {\n\t\treturn {\n\t\t\tvalue: option.value,\n\t\t\tlabel: option.label\n\t\t}\n\t})\n}\n\nfunction buildAppliedFilterOptionsFromMatchRequest(\n\tfilterOptions: DaffCategoryFilterOption[], filterRequest: DaffCategoryFilterMatchRequest\n): DaffCategoryAppliedFilterOption[] {\n\treturn filterOptions\n\t.filter(option => filterRequest.value === option.value)\n\t.map(option => {\n\t\treturn {\n\t\t\tvalue: option.value,\n\t\t\tlabel: option.label\n\t\t}\n\t})\n}\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\n\nimport { DaffCategoryRequest } from '../../models/requests/category-request';\nimport { DaffGenericCategory } from '../../models/generic-category';\nimport { DaffCategoryPageConfigurationState } from '../../models/category-page-configuration-state';\nimport { DaffCategoryReducerState } from '../../reducers/category/category-reducer-state.interface';\nimport { DaffCategoryAppliedFilter } from '../../models/category-applied-filter';\nimport { DaffCategoryReducersState } from '../../reducers/category-reducers.interface';\nimport { getDaffCategoryFeatureSelector } from '../category-feature.selector';\nimport { DaffCategoryFilterRequest } from '../../models/requests/filter-request';\nimport { DaffCategoryFilter } from '../../models/category-filter';\nimport { buildAppliedFilter } from '../applied-filter/applied-filter-methods';\nimport { DaffCategory } from '../../models/category';\n\nexport interface DaffCategoryPageMemoizedSelectors<\n\tT extends DaffCategoryRequest = DaffCategoryRequest, \n\tV extends DaffGenericCategory<V> = DaffCategory, \n\tU extends DaffCategoryPageConfigurationState<T> = DaffCategoryPageConfigurationState<T>\n> {\n\tselectCategoryState: MemoizedSelector<object, DaffCategoryReducerState<T, U>>;\n\tselectCategoryPageConfigurationState: MemoizedSelector<object, U>;\n\tselectCategoryCurrentPage: MemoizedSelector<object, U['current_page']>;\n\tselectCategoryTotalPages: MemoizedSelector<object, U['total_pages']>;\n\tselectCategoryPageSize: MemoizedSelector<object, U['page_size']>;\n\tselectCategoryFilters: MemoizedSelector<object, U['filters']>;\n\tselectCategorySortOptions: MemoizedSelector<object, U['sort_options']>;\n\tselectCategoryPageProductIds: MemoizedSelector<object, U['product_ids']>;\n\tselectIsCategoryPageEmpty: MemoizedSelector<object, boolean>;\n\tselectCategoryPageTotalProducts: MemoizedSelector<object, U['total_products']>;\n\tselectCategoryPageFilterRequests: MemoizedSelector<object, U['filter_requests']>;\n\tselectCategoryPageAppliedFilters: MemoizedSelector<object, DaffCategoryAppliedFilter[]>;\n\tselectCategoryPageAppliedSortOption: MemoizedSelector<object, U['applied_sort_option']>;\n\tselectCategoryPageAppliedSortDirection: MemoizedSelector<object, U['applied_sort_direction']>;\n\tselectSelectedCategoryId: MemoizedSelector<object, U['id']>;\n\tselectCategoryLoading: MemoizedSelector<object, boolean>;\n\tselectCategoryProductsLoading: MemoizedSelector<object, boolean>;\n\tselectCategoryErrors: MemoizedSelector<object, string[]>;\n}\n\nconst createCategoryPageSelectors = <T extends DaffCategoryRequest, V extends DaffGenericCategory<V>, U extends DaffCategoryPageConfigurationState<T>>(): DaffCategoryPageMemoizedSelectors<T, V, U> => {\n\tconst selectCategoryFeatureState = getDaffCategoryFeatureSelector<T, V, U>().selectCategoryFeatureState;\n\n\t/**\n\t * Category State\n\t */\n\tconst selectCategoryState = createSelector(\n\t\tselectCategoryFeatureState,\n\t\t(state: DaffCategoryReducersState<T, V, U>) => state.category\n\t);\n\n\t/**\n\t * CategoryPageConfigurationState State\n\t */\n\tconst selectCategoryPageConfigurationState = createSelector(\n\t\tselectCategoryState,\n\t\t(state: DaffCategoryReducerState<T, U>) => state.categoryPageConfigurationState\n\t);\n\n\tconst selectCategoryCurrentPage = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.current_page\n\t);\n\n\tconst selectCategoryTotalPages = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.total_pages\n\t);\n\n\tconst selectCategoryPageSize = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.page_size\n\t);\n\n\tconst selectCategoryFilters = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.filters\n\t);\n\n\tconst selectCategorySortOptions = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.sort_options\n\t);\n\n\tconst selectCategoryPageProductIds = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.product_ids\n\t);\n\n\tconst selectIsCategoryPageEmpty = createSelector(\n\t\tselectCategoryPageProductIds,\n\t\t(state: V['product_ids']) => !state.length\n\t);\n\n\tconst selectCategoryPageTotalProducts = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.total_products\n\t);\n\n\tconst selectCategoryPageFilterRequests = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.filter_requests\n\t);\n\n\tconst selectCategoryPageAppliedFilters = createSelector(\n\t\tselectCategoryPageFilterRequests,\n\t\tselectCategoryFilters,\n\t\t(filterRequests: DaffCategoryFilterRequest[], availableFilters: DaffCategoryFilter[]): DaffCategoryAppliedFilter[] => {\n\t\t\tif(!availableFilters.length) return [];\n\t\t\treturn filterRequests.map(request => \n\t\t\t\tavailableFilters\n\t\t\t\t\t.filter(availableFilter => availableFilter.name === request.name)\n\t\t\t\t\t.map(filter => buildAppliedFilter(filter, request)).shift()\n\t\t\t);\n\t\t}\n\t);\n\n\tconst selectCategoryPageAppliedSortOption = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.applied_sort_option\n\t);\n\n\tconst selectCategoryPageAppliedSortDirection = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.applied_sort_direction\n\t);\n\n\t/**\n\t * Selected Category Id State\n\t */\n\tconst selectSelectedCategoryId = createSelector(\n\t\tselectCategoryPageConfigurationState,\n\t\t(state: U) => state.id\n\t);\n\n\t/**\n\t * Category Loading State\n\t */\n\tconst selectCategoryLoading = createSelector(\n\t\tselectCategoryState,\n\t\t(state: DaffCategoryReducerState<T, U>) => state.categoryLoading\n\t);\n\n\t/**\n\t * Category Products Loading State\n\t */\n\tconst selectCategoryProductsLoading = createSelector(\n\t\tselectCategoryState,\n\t\t(state: DaffCategoryReducerState<T, U>) => state.productsLoading\n\t);\n\n\t/**\n\t * Load Category Errors\n\t */\n\tconst selectCategoryErrors = createSelector(\n\t\tselectCategoryState,\n\t\t(state: DaffCategoryReducerState<T, U>) => state.errors\n\t);\n\n\treturn { \n\t\tselectCategoryState,\n\t\tselectCategoryPageConfigurationState,\n\t\tselectCategoryCurrentPage,\n\t\tselectCategoryTotalPages,\n\t\tselectCategoryPageSize,\n\t\tselectCategoryFilters,\n\t\tselectCategorySortOptions,\n\t\tselectCategoryPageProductIds,\n\t\tselectIsCategoryPageEmpty,\n\t\tselectCategoryPageTotalProducts,\n\t\tselectCategoryPageFilterRequests,\n\t\tselectCategoryPageAppliedFilters,\n\t\tselectCategoryPageAppliedSortOption,\n\t\tselectCategoryPageAppliedSortDirection,\n\t\tselectSelectedCategoryId,\n\t\tselectCategoryLoading,\n\t\tselectCategoryProductsLoading,\n\t\tselectCategoryErrors\n\t}\n}\n\nexport const getDaffCategoryPageSelectors = (() => {\n\tlet cache;\n\treturn <T extends DaffCategoryRequest, V extends DaffGenericCategory<V>, U extends DaffCategoryPageConfigurationState<T>>(): DaffCategoryPageMemoizedSelectors<T, V, U> => cache = cache \n\t\t? cache \n\t\t: createCategoryPageSelectors<T, V, U>();\n})();\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Dictionary, EntityState } from '@ngrx/entity';\n\nimport { DaffGenericCategory } from '../../models/generic-category';\nimport { DaffCategoryRequest } from '../../models/requests/category-request';\nimport { DaffCategoryPageConfigurationState } from '../../models/category-page-configuration-state';\nimport { DaffCategoryReducersState } from '../../reducers/category-reducers.interface';\nimport { daffCategoryEntitiesAdapter } from '../../reducers/category-entities/category-entities-adapter';\nimport { getDaffCategoryFeatureSelector } from '../category-feature.selector';\nimport { DaffCategory } from '../../models/category';\n\nexport interface DaffCategoryEntitiesMemoizedSelectors<V extends DaffGenericCategory<V> = DaffCategory> {\n\tselectCategoryEntitiesState: MemoizedSelector<object, EntityState<V>>;\n\tselectCategoryIds: MemoizedSelector<object, EntityState<V>['ids']>;\n\tselectCategoryEntities: MemoizedSelector<object, Dictionary<V>>;\n\tselectAllCategories: MemoizedSelector<object, V[]>;\n\tselectCategoryTotal: MemoizedSelector<object, number>;\n}\n\nconst createCategoryFeatureSelectors = <T extends DaffCategoryRequest, V extends DaffGenericCategory<V>, U extends DaffCategoryPageConfigurationState<T>>(): DaffCategoryEntitiesMemoizedSelectors<V> => {\n\n\tconst entitiesSelectors = daffCategoryEntitiesAdapter<V>().getSelectors();\n\tconst categoryFeatureState = getDaffCategoryFeatureSelector<T, V, U>().selectCategoryFeatureState;\n\t/**\n\t * Category Entities State\n\t */\n\tconst selectCategoryEntitiesState = createSelector(\n\t\tcategoryFeatureState,\n\t\t(state: DaffCategoryReducersState<T, V, U>) => state.categoryEntities\n\t);\n\n\tconst selectCategoryIds = createSelector(\n\t\tselectCategoryEntitiesState,\n\t\tentitiesSelectors.selectIds\n\t);\n\n\tconst selectCategoryEntities = createSelector(\n\t\tselectCategoryEntitiesState,\n\t\tentitiesSelectors.selectEntities\n\t);\n\n\tconst selectAllCategories = createSelector(\n\t\tselectCategoryEntitiesState,\n\t\tentitiesSelectors.selectAll\n\t);\n\n\tconst selectCategoryTotal = createSelector(\n\t\tselectCategoryEntitiesState,\n\t\tentitiesSelectors.selectTotal\n\t);\n\n\treturn {\n\t\tselectCategoryEntitiesState,\n\t\tselectCategoryIds,\n\t\tselectCategoryEntities,\n\t\tselectAllCategories,\n\t\tselectCategoryTotal\n\t}\n}\n\nexport const getDaffCategoryEntitiesSelectors = (() => {\n\tlet cache;\n\treturn <T extends DaffCategoryRequest, V extends DaffGenericCategory<V>, U extends DaffCategoryPageConfigurationState<T>>(): DaffCategoryEntitiesMemoizedSelectors<V> => cache = cache \n\t\t? cache \n\t\t: createCategoryFeatureSelectors<T, V, U>();\n})();\n","import { createSelector, MemoizedSelector, MemoizedSelectorWithProps } from '@ngrx/store';\nimport { Dictionary } from '@ngrx/entity';\n\nimport { getDaffProductSelectors, DaffProduct } from '@daffodil/product';\n\nimport { DaffCategoryPageConfigurationState } from '../models/category-page-configuration-state';\nimport { DaffGenericCategory } from '../models/generic-category';\nimport { DaffCategoryRequest } from '../models/requests/category-request';\nimport { DaffCategoryFeatureMemoizedSelectors, getDaffCategoryFeatureSelector } from './category-feature.selector';\nimport { DaffCategoryPageMemoizedSelectors, getDaffCategoryPageSelectors } from './category-page/category-page.selector';\nimport { DaffCategoryEntitiesMemoizedSelectors } from './category-entities/category-entities.selector';\nimport { getDaffCategoryEntitiesSelectors } from './category-entities/category-entities.selector';\nimport { DaffCategory } from '../models/category';\n\nexport interface DaffCategoryMemoizedSelectors<\n\tT extends DaffCategoryRequest = DaffCategoryRequest, \n\tV extends DaffGenericCategory<V> = DaffCategory, \n\tU extends DaffCategoryPageConfigurationState<T> = DaffCategoryPageConfigurationState<T>,\n\tW extends DaffProduct = DaffProduct\n> extends\n\tDaffCategoryFeatureMemoizedSelectors<T, V, U>,\n\tDaffCategoryPageMemoizedSelectors<T, V, U>,\n\tDaffCategoryEntitiesMemoizedSelectors<V> {\n\tselectSelectedCategory: MemoizedSelector<object, V>;\n\tselectCategoryPageProducts: MemoizedSelector<object, W[]>;\n\tselectCategory: MemoizedSelectorWithProps<object, object, V>;\n\tselectProductsByCategory: MemoizedSelectorWithProps<object, object, W[]>;\n\tselectTotalProductsByCategory: MemoizedSelectorWithProps<object, object, number>;\n}\n\nconst createCategorySelectors = <T extends DaffCategoryRequest, V extends DaffGenericCategory<V>, U extends DaffCategoryPageConfigurationState<T>, W extends DaffProduct>(): DaffCategoryMemoizedSelectors<T, V, U, W> => {\n\tconst { selectProductEntities, selectAllProducts } = getDaffProductSelectors<W>();\n\n\tconst {\n\t\tselectCategoryEntities\n\t} = getDaffCategoryEntitiesSelectors<T, V, U>();\n\tconst { \n\t\tselectSelectedCategoryId, \n\t\tselectCategoryPageProductIds \n\t} = getDaffCategoryPageSelectors<T, V, U>();\n\t/**\n\t * Combinatoric Category Selectors\n\t */\n\tconst selectSelectedCategory = createSelector(\n\t\tselectCategoryEntities,\n\t\tselectSelectedCategoryId,\n\t\t(entities: Dictionary<V>, selectedCategoryId: string) => entities[selectedCategoryId]\n\t);\n\n\tconst selectCategoryPageProducts = createSelector(\n\t\tselectCategoryPageProductIds,\n\t\tselectProductEntities,\n\t\t(ids, products: Dictionary<W>) => ids.map(id => products[id]).filter(p => p != null)\n\t);\n\n\tconst selectCategory = createSelector(\n\t\tselectCategoryEntities,\n\t\t(entities: Dictionary<V>, props) =>  entities[props.id]\n\t);\n\n\tconst selectProductsByCategory = createSelector(\n\t\tselectCategoryEntities,\n\t\tselectAllProducts,\n\t\t(entities, products, props) => entities[props.id] && entities[props.id].product_ids\n\t\t\t? products.filter(product => entities[props.id].product_ids.indexOf(product.id) >= 0)\n\t\t\t: null\n\t);\n\n\tconst selectTotalProductsByCategory = createSelector(\n\t\tselectCategoryEntities,\n\t\tselectAllProducts,\n\t\t(entities, products, props) => selectProductsByCategory.projector(entities, products, { id: props.id })\n\t\t\t? selectProductsByCategory.projector(entities, products, { id: props.id }).length\n\t\t\t: null\n\t);\n\n\treturn {\n\t\t...getDaffCategoryFeatureSelector<T, V, U>(),\n\t\t...getDaffCategoryEntitiesSelectors<T, V, U>(),\n\t\t...getDaffCategoryPageSelectors<T, V, U>(),\n\t\tselectSelectedCategory,\n\t\tselectCategoryPageProducts,\n\t\tselectCategory,\n\t\tselectProductsByCategory,\n\t\tselectTotalProductsByCategory\n\t}\n}\n\nexport const getDaffCategorySelectors = (() => {\n\tlet cache;\n\treturn <\n\t\tT extends DaffCategoryRequest = DaffCategoryRequest, \n\t\tV extends DaffGenericCategory<V> = DaffCategory, \n\t\tU extends DaffCategoryPageConfigurationState<T> = DaffCategoryPageConfigurationState<T>, \n\t\tW extends DaffProduct = DaffProduct\n\t>(): DaffCategoryMemoizedSelectors<T, V, U, W> => cache = cache \n\t\t? cache \n\t\t: createCategorySelectors<T, V, U, W>();\n})();\n","import { Injectable, Inject } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { switchMap, catchError, withLatestFrom, map } from 'rxjs/operators';\nimport { of, Observable } from 'rxjs';\nimport { Store, select } from '@ngrx/store';\n\nimport { DaffProductGridLoadSuccess, DaffProduct } from '@daffodil/product';\n\nimport {\n  DaffCategoryActionTypes,\n  DaffChangeCategoryPageSize,\n  DaffChangeCategoryCurrentPage,\n\tDaffChangeCategoryFilters,\n\tDaffChangeCategorySortingOption,\n\tDaffToggleCategoryFilter,\n  DaffCategoryPageLoadSuccess,\n  DaffCategoryPageLoad,\n  DaffCategoryPageLoadFailure\n} from '../actions/category.actions';\nimport { DaffCategoryDriver } from '../drivers/injection-tokens/category-driver.token';\nimport { DaffCategoryServiceInterface } from '../drivers/interfaces/category-service.interface';\nimport { DaffGetCategoryResponse } from '../models/get-category-response';\nimport { getDaffCategorySelectors } from '../selectors/category.selector';\nimport { DaffCategoryRequest } from '../models/requests/category-request';\nimport { DaffCategoryPageConfigurationState } from '../models/category-page-configuration-state';\nimport { DaffGenericCategory } from '../models/generic-category';\nimport { daffCategoryValidateFilters } from '../helpers/public_api';\n\n@Injectable()\nexport class DaffCategoryPageEffects<\n\tT extends DaffCategoryRequest,\n\tV extends DaffGenericCategory<V>,\n\tU extends DaffCategoryPageConfigurationState<T>,\n\tW extends DaffProduct\n> {\n\n  constructor(\n    private actions$: Actions,\n    @Inject(DaffCategoryDriver) private driver: DaffCategoryServiceInterface<T, V, U, W>,\n    private store: Store<any>\n\t){}\n\n\tprivate categorySelectors = getDaffCategorySelectors<T, V, U, W>();\n\n  @Effect()\n  loadCategoryPage$ : Observable<any> = this.actions$.pipe(\n    ofType(DaffCategoryActionTypes.CategoryPageLoadAction),\n    switchMap((action: DaffCategoryPageLoad<T>) => {\n\t\t\tdaffCategoryValidateFilters(action.request.filter_requests);\n\t\t\treturn this.processCategoryGetRequest(action.request)\n\t\t})\n\t)\n\n  @Effect()\n  changeCategoryPageSize$ : Observable<any> = this.actions$.pipe(\n\t\tofType(DaffCategoryActionTypes.ChangeCategoryPageSizeAction),\n    withLatestFrom(\n\t\t\tthis.store.pipe(select(this.categorySelectors.selectCategoryPageConfigurationState))\n\t\t),\n    switchMap((\n\t\t\t[action, categoryRequest]:\n\t\t\t[DaffChangeCategoryPageSize, T]\n\t\t) => this.processCategoryGetRequest({\n\t\t\t...categoryRequest,\n\t\t\tpage_size: action.pageSize\n\t\t}))\n  )\n\n  @Effect()\n  changeCategoryCurrentPage$ : Observable<any> = this.actions$.pipe(\n    ofType(DaffCategoryActionTypes.ChangeCategoryCurrentPageAction),\n    withLatestFrom(\n\t\t\tthis.store.pipe(select(this.categorySelectors.selectCategoryPageConfigurationState))\n    ),\n    switchMap((\n\t\t\t[action, categoryRequest]:\n\t\t\t[DaffChangeCategoryCurrentPage, T]\n\t\t) => this.processCategoryGetRequest({\n\t\t\t...categoryRequest,\n\t\t\tcurrent_page: action.currentPage\n\t\t}))\n  )\n\n  @Effect()\n  changeCategoryFilters$ : Observable<any> = this.actions$.pipe(\n    ofType(DaffCategoryActionTypes.ChangeCategoryFiltersAction),\n    withLatestFrom(\n\t\t\tthis.store.pipe(select(this.categorySelectors.selectCategoryPageConfigurationState))\n    ),\n    switchMap((\n\t\t\t[action, categoryRequest]:\n\t\t\t[DaffChangeCategoryFilters, T]\n\t\t) => {\n\t\t\tdaffCategoryValidateFilters(action.filters);\n\t\t\treturn this.processCategoryGetRequest({\n\t\t\t\t...categoryRequest,\n\t\t\t\tfilter_requests: action.filters\n\t\t\t})\n\t\t})\n  )\n\n  @Effect()\n  toggleCategoryFilter$ : Observable<any> = this.actions$.pipe(\n    ofType(DaffCategoryActionTypes.ToggleCategoryFilterAction),\n    withLatestFrom(\n\t\t\tthis.store.pipe(select(this.categorySelectors.selectCategoryPageConfigurationState))\n    ),\n    switchMap((\n\t\t\t[action, categoryPageConfigurationState]:\n\t\t\t[DaffToggleCategoryFilter, U]\n\t\t) => {\n\t\t\tdaffCategoryValidateFilters(categoryPageConfigurationState.filter_requests);\n\t\t\treturn this.processCategoryGetRequest({\n\t\t\t\t...categoryPageConfigurationState\n\t\t\t})\n\t\t})\n  )\n\n  @Effect()\n  changeCategorySort$ : Observable<any> = this.actions$.pipe(\n    ofType(DaffCategoryActionTypes.ChangeCategorySortingOptionAction),\n    withLatestFrom(\n\t\t\tthis.store.pipe(select(this.categorySelectors.selectCategoryPageConfigurationState))\n    ),\n    switchMap((\n\t\t\t[action, categoryRequest]:\n\t\t\t[DaffChangeCategorySortingOption, T]\n\t\t) => this.processCategoryGetRequest({\n\t\t\t...categoryRequest,\n\t\t\tapplied_sort_option: action.sort.option,\n\t\t\tapplied_sort_direction: action.sort.direction\n\t\t}))\n\t)\n\n  private processCategoryGetRequest(payload: T) {\n    return this.driver.get(payload).pipe(\n      switchMap((resp: DaffGetCategoryResponse<T, V, U, W>) => [\n        new DaffProductGridLoadSuccess(resp.products),\n        new DaffCategoryPageLoadSuccess(resp)\n      ]),\n      catchError(error => of(new DaffCategoryPageLoadFailure('Failed to load the category')))\n    )\n\t}\n}\n","import { NgModule } from '@angular/core';\nimport { StoreModule } from '@ngrx/store';\nimport { EffectsModule } from '@ngrx/effects';\n\nimport { daffCategoryReducers } from './reducers/category-reducers';\nimport { DaffCategoryEffects } from './effects/category.effects';\nimport { DaffDefaultCategoryPageSize } from './resolvers/public_api';\nimport { DaffCategoryPageEffects } from './effects/category-page.effects';\n\n@NgModule({\n  imports: [\n    StoreModule.forFeature('category', daffCategoryReducers),\n    EffectsModule.forFeature([DaffCategoryEffects, DaffCategoryPageEffects]),\n\t],\n\tproviders: [\n\t\t{ provide: DaffDefaultCategoryPageSize, useValue: 12 }\n\t]\n})\nexport class DaffCategoryStateModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { DaffCategoryStateModule } from './category-state.module';\nimport { DaffProductModule } from '@daffodil/product';\n\n@NgModule({\n  imports: [\n    CommonModule,\n\n    /**\n     * Ngrx/store\n     */\n    DaffCategoryStateModule,\n    DaffProductModule\n  ]\n})\nexport class DaffCategoryModule { }\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Store, select, Action } from '@ngrx/store';\n\nimport { DaffProduct } from '@daffodil/product';\n\nimport { DaffCategoryModule } from '../category.module';\nimport { getDaffCategorySelectors } from '../selectors/category.selector';\nimport { DaffCategoryReducersState } from '../reducers/category-reducers.interface';\nimport { DaffCategoryPageConfigurationState } from '../models/category-page-configuration-state';\nimport { DaffCategoryFilter } from '../models/category-filter';\nimport { DaffCategorySortOption } from '../models/category-sort-option';\nimport { DaffSortDirectionEnum, DaffCategoryRequest } from '../models/requests/category-request';\nimport { DaffCategoryAppliedFilter } from '../models/category-applied-filter';\nimport { DaffGenericCategory } from '../models/generic-category';\nimport { DaffCategory } from '../models/category';\nimport { DaffCategoryFacadeInterface } from './category-facade.interface';\n\n/**\n * A facade for accessing state for the currently selected category.\n */\n@Injectable({\n  providedIn: DaffCategoryModule\n})\nexport class DaffCategoryFacade<\n\tT extends DaffCategoryRequest = DaffCategoryRequest, \n\tV extends DaffGenericCategory<V> = DaffCategory, \n\tU extends DaffCategoryPageConfigurationState<T> = DaffCategoryPageConfigurationState<T>,\n\tW extends DaffProduct = DaffProduct\n> implements DaffCategoryFacadeInterface<T, V, U, W> {\n\tprivate categorySelectors = getDaffCategorySelectors<T, V, U, W>();\n\t\n\t/**\n   * The currently selected category.\n   */\n  category$: Observable<V>;\n  /**\n   * The page configuration state for the selected category.\n   */\n  pageConfigurationState$: Observable<U>;\n  /**\n   * The current page of products for the selected category.\n   */\n  currentPage$: Observable<number>;\n  /**\n   * The number of pages of product for the selected category.\n   */\n\ttotalPages$: Observable<number>;\n\t/**\n\t * The total number of products for the filters applied.\n\t */\n\ttotalProducts$: Observable<number>;\n  /**\n   * The number of products per page for the selected category.\n   */\n  pageSize$: Observable<number>;\n  /**\n   * The filters available for the products of the selected category.\n   */\n  filters$: Observable<DaffCategoryFilter[]>;\n  /**\n   * The sort options available for the products of the selected category.\n   */\n  sortOptions$: Observable<DaffCategorySortOption[]>;\n  /**\n   * The sort options available for the products of the selected category.\n   */\n  appliedFilters$: Observable<DaffCategoryAppliedFilter[]>;\n  /**\n   * The sort options available for the products of the selected category.\n   */\n  appliedSortOption$: Observable<string>;\n  /**\n   * The sort options available for the products of the selected category.\n   */\n  appliedSortDirection$: Observable<DaffSortDirectionEnum>;\n  /**\n   * Products of the currently selected category.\n   */\n  products$: Observable<W[]>;\n  /**\n   * The loading state for retrieving a single category.\n   */\n  categoryLoading$: Observable<boolean>;\n  /**\n   * The loading state for retrieving only the products of the category.\n   */\n  productsLoading$: Observable<boolean>;\n  /**\n   * Errors associated with retrieving a single category.\n   */\n\terrors$: Observable<string[]>;\n\t/**\n\t * Is the category page empty of products.\n\t */\n\tisCategoryEmpty$: Observable<boolean>;\n\t\n\t/**\n\t * Get a category by the provided Id.\n\t * @param id \n\t */\n\tgetCategoryById(id: string): Observable<V> {\n\t\treturn this.store.pipe(select(this.categorySelectors.selectCategory, {id: id}));\n\t}\n\n\t/**\n\t * Get products by a category Id.\n\t * @param categoryId \n\t */\n\tgetProductsByCategory(categoryId: string): Observable<W[]> {\n\t\treturn this.store.pipe(select(this.categorySelectors.selectProductsByCategory, {id: categoryId}))\n\t}\n\n\t/**\n\t * Get products by a category Id.\n\t * @param categoryId \n\t */\n\tgetTotalProductsByCategory(categoryId: string): Observable<number> {\n\t\treturn this.store.pipe(select(this.categorySelectors.selectTotalProductsByCategory, {id: categoryId}))\n\t}\n\n  constructor(private store: Store<DaffCategoryReducersState<T, V, U>>) {\n    this.category$ = this.store.pipe(select(this.categorySelectors.selectSelectedCategory));\n\t\tthis.products$ = this.store.pipe(select(this.categorySelectors.selectCategoryPageProducts));\n\t\tthis.totalProducts$ = this.store.pipe(select(this.categorySelectors.selectCategoryPageTotalProducts));\n    this.pageConfigurationState$ = this.store.pipe(select(this.categorySelectors.selectCategoryPageConfigurationState));\n    this.currentPage$ = this.store.pipe(select(this.categorySelectors.selectCategoryCurrentPage));\n    this.totalPages$ = this.store.pipe(select(this.categorySelectors.selectCategoryTotalPages));\n    this.pageSize$ = this.store.pipe(select(this.categorySelectors.selectCategoryPageSize));\n    this.filters$ = this.store.pipe(select(this.categorySelectors.selectCategoryFilters));\n    this.sortOptions$ = this.store.pipe(select(this.categorySelectors.selectCategorySortOptions));\n    this.appliedFilters$ = this.store.pipe(select(this.categorySelectors.selectCategoryPageAppliedFilters));\n    this.appliedSortOption$ = this.store.pipe(select(this.categorySelectors.selectCategoryPageAppliedSortOption));\n    this.appliedSortDirection$ = this.store.pipe(select(this.categorySelectors.selectCategoryPageAppliedSortDirection));\n    this.categoryLoading$ = this.store.pipe(select(this.categorySelectors.selectCategoryLoading));\n    this.productsLoading$ = this.store.pipe(select(this.categorySelectors.selectCategoryProductsLoading));\n\t\tthis.errors$ = this.store.pipe(select(this.categorySelectors.selectCategoryErrors));\n\t\tthis.isCategoryEmpty$ = this.store.pipe(select(this.categorySelectors.selectIsCategoryPageEmpty));\n\t}\n\n  /**\n   * Dispatches the given action.\n   * @param action action to dispatch.\n   */\n  dispatch(action: Action) {\n    this.store.dispatch(action);\n  }\n}\n","import gql from 'graphql-tag';\n\nexport const MagentoGetCategoryQuery = gql`\nquery MagentoGetCategoryQuery($filters: CategoryFilterInput){\n\tcategoryList(filters: $filters) {\n\t\tid\n\t\tname\n\t\tlevel\n\t\tdescription\n\t\tbreadcrumbs {\n\t\t\tcategory_id\n\t\t\tcategory_name\n\t\t\tcategory_level\n\t\t\tcategory_url_key\n\t\t}\n\t\tproducts {\n\t\t\titems {\n\t\t\t\tsku\n\t\t\t}\n\t\t}\n\t\tchildren_count\n\t}\n}`\n","import gql from 'graphql-tag';\nimport { magentoProductFragment } from '@daffodil/product';\n\n/**\n * This query only exists because products and their associated aggregations/filter cannot\n * be retrieved through a category call.\n */\nexport const MagentoGetProductsQuery = gql`\nquery MagentoGetProducts($filter: ProductAttributeFilterInput!, $search: String, $pageSize: Int, $currentPage: Int, $sort: ProductAttributeSortInput)\n{\n\tproducts(filter: $filter, search: $search, pageSize: $pageSize, currentPage: $currentPage, sort: $sort)\n\t{\n\t\ttotal_count\n\t\titems {\n\t\t\t...product\n\t\t}\n\t\tpage_info {\n\t\t\tpage_size\n\t\t\tcurrent_page\n\t\t\ttotal_pages\n\t\t}\n\t}\n}\n${magentoProductFragment}\n`\n","export enum MagentoCategoryFilterActionEnum {\n\tEqual = 'eq',\n\tTo = 'to',\n\tFrom = 'from',\n\tIn = 'in',\n\tMatch = 'match'\n}\n\nexport interface MagentoCategoryFilters {\n\t[x: string]: MagentoFilterAction;\n}\n\nexport type MagentoFilterAction = {\n\t[key in MagentoCategoryFilterActionEnum]?: string | string[];\n}\n","import { Injectable } from '@angular/core';\n\nimport { MagentoCategoryFilters, MagentoCategoryFilterActionEnum } from '../models/requests/filters';\nimport { DaffCategoryFilterRequest, DaffCategoryFromToFilterSeparator } from '../../../models/requests/filter-request';\nimport { DaffCategoryFilterType } from '../../../models/category-filter-base';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DaffMagentoAppliedFiltersTransformService {\n\n  transform(categoryId: string, daffFilters: DaffCategoryFilterRequest[]): MagentoCategoryFilters {\n\t\tconst magentoFilters: MagentoCategoryFilters = {\n\t\t\tcategory_id: {\n\t\t\t\t[MagentoCategoryFilterActionEnum.Equal]: categoryId\n\t\t\t}\n\t\t};\n\n\t\tif(!daffFilters) return magentoFilters;\n\n\t\tdaffFilters.forEach(filter => {\n\t\t\t// The FromTo filter needs special treatment, because Magento accepts the \"from\" and \"to\" filters\n\t\t\t// separately (it also outputs FromTo filter pairs together)\n\t\t\tif(filter.type === DaffCategoryFilterType.Range) {\n\t\t\t\tconst fromToValues = filter.value[0].split(DaffCategoryFromToFilterSeparator);\n\t\t\t\tmagentoFilters[filter.name] = {\n\t\t\t\t\t...magentoFilters[filter.name],\n\t\t\t\t\t...this.getRangeFromValue(fromToValues[0]),\n\t\t\t\t\t...this.getRangeToValue(fromToValues[1])\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmagentoFilters[filter.name] = {\n\t\t\t\t\t...magentoFilters[filter.name],\n\t\t\t\t\t[this.getFilterAction(filter.type)]: this.getFilterValue(filter.type, filter.value)\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn magentoFilters;\n\t}\n\t\n\t/**\n\t * Returns an In action for Equal type and a Match action for Match type.\n\t */\n\tprivate getFilterAction(type: DaffCategoryFilterType): MagentoCategoryFilterActionEnum {\n\t\treturn type === DaffCategoryFilterType.Equal \n\t\t\t? MagentoCategoryFilterActionEnum.In\n\t\t\t: MagentoCategoryFilterActionEnum.Match;\n\t}\n\n\t/**\n\t * Returns an array for Equal type and a string for Match type.\n\t */\n\tprivate getFilterValue(type: DaffCategoryFilterType, value: DaffCategoryFilterRequest['value']): string | string[] {\n\t\treturn type === DaffCategoryFilterType.Equal ? value : value[0];\n\t}\n\n\tprivate getRangeFromValue(fromValue: string) {\n\t\treturn fromValue !== '*' ? {[MagentoCategoryFilterActionEnum.From]: fromValue} : null;\n\t}\n\n\tprivate getRangeToValue(toValue: string) {\n\t\treturn toValue !== '*' ? {[MagentoCategoryFilterActionEnum.To]: toValue} : null;\n\t}\n}\n","export enum MagentoSortDirectionEnum {\n\tAscending = 'ASC',\n\tDecending = 'DESC'\n}\n\nexport interface MagentoSortFieldAction {\n\t[x: string]: MagentoSortDirectionEnum;\n}\n","import { DaffCategoryFilterRequest } from './filter-request';\n\nexport enum DaffSortDirectionEnum {\n\tAscending = 'ASC',\n\tDecending = 'DSC'\n}\n\nexport interface DaffCategoryRequest {\n  id: string;\n  filter_requests?: DaffCategoryFilterRequest[];\n  applied_sort_option?: string;\n  applied_sort_direction?: DaffSortDirectionEnum;\n  current_page?: number;\n  page_size?: number;\n}\n","import { Injectable } from '@angular/core';\n\nimport { MagentoSortFieldAction, MagentoSortDirectionEnum } from '../models/requests/sort';\nimport { DaffSortDirectionEnum } from '../../../models/requests/category-request';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DaffMagentoAppliedSortOptionTransformService {\n\n  transform(appliedOption: string, appliedDirection: DaffSortDirectionEnum): MagentoSortFieldAction {\n\t\treturn {\n\t\t\t[appliedOption]: this.transformDirection(appliedDirection)\n\t\t}\n\t}\n\t\n\tprivate transformDirection(direction: DaffSortDirectionEnum): MagentoSortDirectionEnum {\n\t\tif(direction === DaffSortDirectionEnum.Ascending) {\n\t\t\treturn MagentoSortDirectionEnum.Ascending;\n\t\t} else if(direction === DaffSortDirectionEnum.Decending) {\n\t\t\treturn MagentoSortDirectionEnum.Decending;\n\t\t}\n\t}\n}\n","import { MagentoSortFields } from '../../models/sort-fields'\n\nexport function coerceDefaultSortOptionFirst(sort_fields: MagentoSortFields): MagentoSortFields {\n  const index = sort_fields.options.findIndex(option => sort_fields.default === option.value)\n\n  return {\n    ...sort_fields,\n    options: [\n      sort_fields.options[index],\n      ...sort_fields.options.slice(0, index),\n      ...sort_fields.options.slice(index + 1)\n    ]\n  }\n}\n","import { Injectable } from '@angular/core';\n\nimport { DaffCategoryPageConfigurationState } from '../../../models/category-page-configuration-state';\nimport { DaffCategoryFilter } from '../../../models/category-filter';\nimport { MagentoAggregation } from '../models/aggregation';\nimport { MagentoSortFields } from '../models/sort-fields';\nimport { MagentoCompleteCategoryResponse } from '../models/complete-category-response';\nimport { DaffCategoryFromToFilterSeparator } from '../../../models/requests/filter-request';\nimport { DaffCategoryFilterType } from '../../../models/category-filter-base';\nimport { DaffCategoryRequest } from '../../../models/requests/category-request';\nimport { coerceDefaultSortOptionFirst } from './pure/sort-default-option-first';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DaffMagentoCategoryPageConfigTransformerService {\n\n  transform(categoryResponse: MagentoCompleteCategoryResponse): DaffCategoryPageConfigurationState<DaffCategoryRequest> {\n\t\treturn {\n      id: categoryResponse.category.id,\n      page_size: categoryResponse.page_info.page_size,\n      current_page: categoryResponse.page_info.current_page,\n\t\t\ttotal_pages: categoryResponse.page_info.total_pages,\n\t\t\ttotal_products: categoryResponse.total_count,\n      filters: categoryResponse.aggregates.map(this.transformAggregate.bind(this)),\n\t\t\tsort_options: coerceDefaultSortOptionFirst(categoryResponse.sort_fields).options,\n\t\t\tproduct_ids: categoryResponse.products.map(product => product.sku)\n    }\n  }\n\n  private transformAggregate(filter: MagentoAggregation): DaffCategoryFilter {\n\t\tconst filterType = this.transformAggregateType(filter.type)\n    return {\n      label: filter.label,\n      type: filterType,\n\t\t\tname: filter.attribute_code,\n\t\t\toptions: filter.options.map(option => {\n\t\t\t\treturn {\n\t\t\t\t\tlabel: option.label,\n\t\t\t\t\tvalue: filterType === DaffCategoryFilterType.Range ? this.transformRangeValue(option.value) : option.value,\n\t\t\t\t\tcount: option.count\n\t\t\t\t}\n\t\t\t})\n    }\n\t}\n\n\tprivate transformAggregateType(type: MagentoAggregation['type']): DaffCategoryFilterType {\n\t\tif(type === 'select') return DaffCategoryFilterType.Equal;\n\t\telse if(type === 'boolean') return DaffCategoryFilterType.Equal;\n\t\telse if(type === 'multiselect') return DaffCategoryFilterType.Equal;\n\t\telse if(type === 'price') return DaffCategoryFilterType.Range;\n\t\telse return DaffCategoryFilterType.Match;\n\t}\n\n\tprivate transformRangeValue(value: string): string {\n\t\treturn value.replace('_', DaffCategoryFromToFilterSeparator);\n\t}\n}\n","import { Injectable } from '@angular/core';\n\nimport { DaffCategory } from '../../../models/category';\nimport { DaffCategoryBreadcrumb } from '../../../models/category-breadcrumb';\nimport { MagentoBreadcrumb, MagentoCategory } from '../models/category';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DaffMagentoCategoryTransformerService {\n\n  transform(category: MagentoCategory): DaffCategory {\n    return {\n      id: category.id,\n\t\t\tname: category.name,\n\t\t\tdescription: category.description,\n\t\t\tchildren_count: category.children_count,\n\t\t\t//todo: use optional chaining when possible\n\t\t\tbreadcrumbs: category.breadcrumbs ? \n\t\t\t\tcategory.breadcrumbs\n\t\t\t\t\t.map(breadcrumb => this.transformBreadcrumb(breadcrumb))\n\t\t\t\t\t.sort((a, b) => a.categoryLevel - b.categoryLevel) : \n\t\t\t\tnull,\n\t\t\tproduct_ids: category.products.items.map(product => product.sku),\n\t\t\ttotal_products: category.products.items.length\n    }\n  }\n\n  private transformBreadcrumb(breadcrumb: MagentoBreadcrumb): DaffCategoryBreadcrumb {\n    return {\n      categoryId: breadcrumb.category_id,\n      categoryName: breadcrumb.category_name,\n      categoryLevel: breadcrumb.category_level,\n      categoryUrlKey: breadcrumb.category_url_key\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\n\nimport { transformManyMagentoProducts } from '@daffodil/product';\n\nimport { DaffMagentoCategoryPageConfigTransformerService } from './category-page-config-transformer.service';\nimport { MagentoCompleteCategoryResponse } from '../models/complete-category-response';\nimport { DaffGetCategoryResponse } from '../../../models/get-category-response';\nimport { DaffMagentoCategoryTransformerService } from './category-transformer.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DaffMagentoCategoryResponseTransformService {\n\n  constructor(\n    private magentoCategoryTransformerService: DaffMagentoCategoryTransformerService,\n    private magentoCategoryPageConfigurationTransformerService: DaffMagentoCategoryPageConfigTransformerService\n  ) {}\n\n  transform(completeCategory: MagentoCompleteCategoryResponse): DaffGetCategoryResponse {\n    return {\n\t\t\t...{ magentoCompleteCategoryResponse: completeCategory },\n      category: this.magentoCategoryTransformerService.transform(completeCategory.category),\n      categoryPageConfigurationState: this.magentoCategoryPageConfigurationTransformerService.transform(completeCategory),\n      products: transformManyMagentoProducts(completeCategory.products)\n    }\n  }\n}\n","import gql from 'graphql-tag';\n\n/**\n * This query only exists because products and their associated aggregations/filter cannot\n * be retrieved through a category call.\n */\nexport const MagentoGetCategoryAggregations = gql`\nquery MagentoGetProducts($filter: ProductAttributeFilterInput!)\n{\n\tproducts(filter: $filter)\n\t{\n\t\taggregations {\n\t\t\tlabel\n\t\t\tcount\n\t\t\tattribute_code\n\t\t\toptions {\n\t\t\t\t\tcount\n\t\t\t\t\tlabel\n\t\t\t\t\tvalue\n\t\t\t}\n\t\t}\n\t\tsort_fields {\n\t\t\tdefault\n\t\t\toptions {\n\t\t\t\tlabel\n\t\t\t\tvalue\n\t\t\t}\n\t\t}\n\t}\n}`\n","import gql from 'graphql-tag';\n\n/**\n * A query for getting aggregation types.\n */\nexport const MagentoGetCustomAttributeMetadata = gql`\nquery MagentoGetCustomAttributeMetadata($attributes: [AttributeInput!]!)\n{\n\tcustomAttributeMetadata(attributes: $attributes)\n\t{\n\t\titems {\n      attribute_code\n      attribute_type\n      input_type\n    }\n\t}\n}`\n","import { MagentoAggregation } from '../models/aggregation';\nimport { MagentoCustomMetadataAttribute } from '../models/requests/custom-metadata-attribute';\nimport { MagentoCustomAttributeMetadataResponse } from '../models/custom-attribute-metadata-response';\nimport { MagentoGetCategoryAggregationsResponse } from '../models/get-category-aggregations-response';\n\nexport function buildCustomMetadataAttribute(filter: MagentoAggregation): MagentoCustomMetadataAttribute {\n\treturn {\n\t\tattribute_code: filter.attribute_code,\n\t\tentity_type: '4'\n\t}\n}\n\nexport function addMetadataTypesToAggregates(\n\tattributeResponse: MagentoCustomAttributeMetadataResponse, \n\taggregationResponse: MagentoGetCategoryAggregationsResponse\n): MagentoGetCategoryAggregationsResponse {\n\n\treturn {\n\t\t...aggregationResponse,\n\t\tproducts: {\n\t\t\t...aggregationResponse.products,\n\t\t\taggregations: [\n\t\t\t\t...aggregationResponse.products.aggregations.map((aggregate) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...aggregate,\n\t\t\t\t\t\ttype: getMatchedAttributeType(aggregate, attributeResponse)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t}\n\t}\n}\n\nfunction getMatchedAttributeType(aggregate: MagentoAggregation, attributes: MagentoCustomAttributeMetadataResponse): string {\n\tif(aggregate.attribute_code === 'category_id') return 'select';\n\n\treturn attributes.customAttributeMetadata.items.filter(item => item.attribute_code === aggregate.attribute_code)[0].input_type;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, combineLatest } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { Apollo } from 'apollo-angular';\n\nimport { DaffCategoryServiceInterface } from '../interfaces/category-service.interface';\nimport { DaffGetCategoryResponse } from '../../models/get-category-response';\nimport { DaffCategoryRequest } from '../../models/requests/category-request';\nimport { MagentoCompleteCategoryResponse } from './models/complete-category-response';\nimport { MagentoGetACategoryResponse } from './models/get-category-response';\nimport { MagentoGetCategoryQuery } from './queries/get-category';\nimport { MagentoGetProductsResponse } from './models/get-products-response';\nimport { MagentoGetProductsQuery } from './queries/get-products';\nimport { DaffMagentoAppliedFiltersTransformService } from './transformers/applied-filter-transformer.service';\nimport { DaffMagentoAppliedSortOptionTransformService } from './transformers/applied-sort-option-transformer.service';\nimport { DaffMagentoCategoryResponseTransformService } from './transformers/category-response-transform.service';\nimport { MagentoGetProductsByCategoriesRequest } from './models/requests/get-products-by-categories-request';\nimport { MagentoGetCategoryAggregations } from './queries/get-category-aggregations';\nimport { MagentoGetCategoryAggregationsResponse } from './models/get-category-aggregations-response';\nimport { MagentoCustomAttributeMetadataResponse } from './models/custom-attribute-metadata-response';\nimport { MagentoGetCustomAttributeMetadata } from './queries/custom-attribute-metadata';\nimport { buildCustomMetadataAttribute, addMetadataTypesToAggregates } from './transformers/custom-metadata-attributes-methods';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DaffMagentoCategoryService implements DaffCategoryServiceInterface {\n  \n  constructor(\n    private apollo: Apollo,\n\t\tprivate magentoCategoryResponseTransformer: DaffMagentoCategoryResponseTransformService,\n\t\tprivate magentoAppliedFiltersTransformer: DaffMagentoAppliedFiltersTransformService,\n\t\tprivate magentoAppliedSortTransformer: DaffMagentoAppliedSortOptionTransformService\n  ) {}\n\n\t//todo the MagentoGetCategoryQuery needs to get its own product ids.\n  /**\n   * Gets a category based on parameters. Default current_page is 1, and default page_size is 20.\n   * @param categoryRequest A DaffCategoryRequest object.\n   */\n  get(categoryRequest: DaffCategoryRequest): Observable<DaffGetCategoryResponse> {\n    return combineLatest([\n      this.apollo.query<MagentoGetACategoryResponse>({\n\t\t\t\tquery: MagentoGetCategoryQuery,\n\t\t\t\tvariables: { filters: {ids: { eq: categoryRequest.id}}}\n\t\t\t}),\n      this.apollo.query<MagentoGetCategoryAggregationsResponse>({\n\t\t\t\tquery: MagentoGetCategoryAggregations,\n\t\t\t\tvariables: {filter: {category_id: {eq: categoryRequest.id}}}\n\t\t\t}).pipe(\n\t\t\t\tswitchMap((aggregationResult): Observable<MagentoGetCategoryAggregationsResponse> => \n\t\t\t\t\tthis.apollo.query<MagentoCustomAttributeMetadataResponse>({\n\t\t\t\t\t\tquery: MagentoGetCustomAttributeMetadata,\n\t\t\t\t\t\tvariables: { \n\t\t\t\t\t\t\tattributes: aggregationResult.data.products.aggregations\n\t\t\t\t\t\t\t\t.filter(aggregate => aggregate.attribute_code !== 'category_id')\n\t\t\t\t\t\t\t\t.map(aggregate => buildCustomMetadataAttribute(aggregate))\n\t\t\t\t\t\t}\n\t\t\t\t\t}).pipe(\n\t\t\t\t\t\tmap(response => addMetadataTypesToAggregates(response.data, aggregationResult.data))\n\t\t\t\t\t)\n\t\t\t\t),\n\t\t\t),\n      this.apollo.query<MagentoGetProductsResponse>({\n\t\t\t\tquery: MagentoGetProductsQuery,\n\t\t\t\tvariables: this.getProductsQueryVariables(categoryRequest)\n\t\t\t})\n    ]).pipe(\n      map((result): MagentoCompleteCategoryResponse => this.buildCompleteCategoryResponse(result[0].data, result[1], result[2].data)),\n\t\t\tmap((finalResult: MagentoCompleteCategoryResponse) => this.magentoCategoryResponseTransformer.transform(finalResult))\n\t\t);\n\t}\n\t\n\tprivate getProductsQueryVariables(request: DaffCategoryRequest): MagentoGetProductsByCategoriesRequest {\n\t\tconst queryVariables = {\n\t\t\tfilter: this.magentoAppliedFiltersTransformer.transform(request.id, request.filter_requests)\n\t\t};\n\t\tif(request.page_size) queryVariables['pageSize'] = request.page_size;\n\t\tif(request.current_page) queryVariables['currentPage'] = request.current_page;\n\t\tif(request.applied_sort_option && request.applied_sort_direction) {\n\t\t\tqueryVariables['sort'] = this.magentoAppliedSortTransformer.transform(request.applied_sort_option, request.applied_sort_direction);\n\t\t}\n\n\t\treturn queryVariables;\n\t}\n\n\tprivate buildCompleteCategoryResponse(\n\t\tcategoryResponse: MagentoGetACategoryResponse, \n\t\taggregationsAndSortsResponse: MagentoGetCategoryAggregationsResponse,\n\t\tproductsResponse: MagentoGetProductsResponse\n\t): MagentoCompleteCategoryResponse {\n\t\treturn {\n\t\t\tcategory: categoryResponse.categoryList[0],\n\t\t\tproducts: productsResponse.products.items,\n\t\t\taggregates: aggregationsAndSortsResponse.products.aggregations,\n\t\t\tsort_fields: aggregationsAndSortsResponse.products.sort_fields,\n\t\t\ttotal_count: productsResponse.products.total_count,\n\t\t\tpage_info: productsResponse.products.page_info\n\t\t};\n\t}\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { DaffMagentoCategoryService } from './category.service';\nimport { DaffMagentoCategoryResponseTransformService } from './transformers/category-response-transform.service';\nimport { DaffMagentoCategoryTransformerService } from './transformers/category-transformer.service';\nimport { DaffMagentoCategoryPageConfigTransformerService } from './transformers/category-page-config-transformer.service';\nimport { DaffCategoryDriver } from '../injection-tokens/category-driver.token';\nimport { DaffMagentoAppliedSortOptionTransformService } from './transformers/applied-sort-option-transformer.service';\nimport { DaffMagentoAppliedFiltersTransformService } from './transformers/applied-filter-transformer.service';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ]\n})\nexport class DaffCategoryMagentoDriverModule {\n  static forRoot(): ModuleWithProviders {\n    return {\n      ngModule: DaffCategoryMagentoDriverModule,\n      providers: [\n\t\t\t\t{\n\t\t\t\t\tprovide: DaffCategoryDriver,\n\t\t\t\t\tuseExisting: DaffMagentoCategoryService\n\t\t\t\t},\n\t\t\t\tDaffMagentoCategoryPageConfigTransformerService,\n\t\t\t\tDaffMagentoCategoryResponseTransformService,\n\t\t\t\tDaffMagentoCategoryTransformerService,\n\t\t\t\tDaffMagentoAppliedFiltersTransformService,\n\t\t\t\tDaffMagentoAppliedSortOptionTransformService\n      ]\n    };\n  }\n}\n","import { DaffCategoryFilterBase } from './category-filter-base';\n\nexport interface DaffCategoryAppliedFilter extends DaffCategoryFilterBase {\n\toptions: DaffCategoryAppliedFilterOption[];\n}\n\nexport interface DaffCategoryAppliedFilterOption {\n\tlabel: string;\n\tvalue: string;\n}\n"],"names":["createEntityAdapter","InjectionToken","ofType","switchMap","of","DaffProductGridLoadSuccess","catchError","Injectable","Actions","Inject","tslib_1.__decorate","Effect","Observable","isPlatformBrowser","mapTo","take","PLATFORM_ID","Store","ActionsSubject","createFeatureSelector","createSelector","store","withLatestFrom","select","NgModule","StoreModule","EffectsModule","CommonModule","DaffProductModule","magentoProductFragment","transformManyMagentoProducts","combineLatest","map","Apollo"],"mappings":"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"}
{"version":3,"file":"daffodil-order-state.umd.js","sources":["ng://@daffodil/order/state/actions/order.actions.ts","ng://@daffodil/order/state/reducers/order/order-initial-state.ts","ng://@daffodil/order/state/reducers/order/order.reducer.ts","ng://@daffodil/order/state/reducers/order-entities/order-entities-adapter.ts","ng://@daffodil/order/state/reducers/order-entities/order-entities-initial-state.ts","ng://@daffodil/order/state/reducers/order-entities/order-entities.reducer.ts","ng://@daffodil/order/state/reducers/order-reducers.ts","ng://@daffodil/order/state/reducers/order-store-feature-key.ts","ng://@daffodil/order/state/selectors/order-feature.selector.ts","ng://@daffodil/order/state/selectors/order-entities.selector.ts","ng://@daffodil/order/state/selectors/order.selector.ts","ng://@daffodil/order/state/selectors/order-all.selector.ts","ng://@daffodil/order/state/facades/order/order.facade.ts","ng://@daffodil/order/state/guards/placed-order/placed-order-guard-redirect.token.ts","ng://@daffodil/order/state/guards/placed-order/placed-order.guard.ts","ng://@daffodil/order/state/effects/order.effects.ts","ng://@daffodil/order/state/order-state.module.ts"],"sourcesContent":["import { Action } from '@ngrx/store';\n\nimport { DaffCart } from '@daffodil/cart';\nimport { DaffOrder } from '@daffodil/order';\n\nexport enum DaffOrderActionTypes {\n  OrderLoadAction = '[Order] Order Load Action',\n  OrderLoadSuccessAction = '[Order] Order Load Success Action',\n  OrderLoadFailureAction = '[Order] Order Load Failure Action',\n  OrderListAction = '[Order] Order List Action',\n  OrderListSuccessAction = '[Order] Order List Success Action',\n  OrderListFailureAction = '[Order] Order List Failure Action'\n}\n\n/**\n * Triggers the loading of the specified order.\n *\n * @param orderId The order ID.\n * @param cartId The optional guest cart ID.\n */\nexport class DaffOrderLoad<\n  T extends DaffOrder = DaffOrder,\n  V extends DaffCart = DaffCart\n> implements Action {\n  readonly type = DaffOrderActionTypes.OrderLoadAction;\n\n  constructor(public orderId: T['id'], public cartId?: V['id']) {}\n}\n\nexport class DaffOrderLoadSuccess<T extends DaffOrder = DaffOrder> implements Action {\n  readonly type = DaffOrderActionTypes.OrderLoadSuccessAction;\n\n  constructor(public payload: T) {}\n}\n\nexport class DaffOrderLoadFailure implements Action {\n  readonly type = DaffOrderActionTypes.OrderLoadFailureAction;\n\n  constructor(public payload: string) {}\n}\n\n/**\n * Triggers the loading of the orders for either the currently logged-in user or the specified guest cart.\n *\n * @param payload The guest cart ID.\n */\nexport class DaffOrderList<T extends DaffCart = DaffCart> implements Action {\n  readonly type = DaffOrderActionTypes.OrderListAction;\n\n  constructor(public payload?: T['id']) {}\n}\n\nexport class DaffOrderListSuccess<T extends DaffOrder = DaffOrder> implements Action {\n  readonly type = DaffOrderActionTypes.OrderListSuccessAction;\n\n  constructor(public payload: T[]) {}\n}\n\nexport class DaffOrderListFailure implements Action {\n  readonly type = DaffOrderActionTypes.OrderListFailureAction;\n\n  constructor(public payload: string) {}\n}\n\nexport type DaffOrderActions<\n  T extends DaffOrder = DaffOrder,\n  V extends DaffCart = DaffCart\n> =\n  | DaffOrderLoad<T, V>\n  | DaffOrderLoadSuccess<T>\n  | DaffOrderLoadFailure\n  | DaffOrderList\n  | DaffOrderListSuccess<T>\n  | DaffOrderListFailure\n","import { DaffOrderReducerState } from './order-reducer.interface';\n\nexport const daffOrderInitialState: DaffOrderReducerState = {\n  loading: false,\n  errors: []\n};\n","import { DaffOrder } from '@daffodil/order';\n\nimport { DaffOrderActions, DaffOrderActionTypes } from '../../actions/order.actions';\nimport { DaffOrderReducerState } from './order-reducer.interface';\nimport { daffOrderInitialState } from './order-initial-state';\n\nexport function daffOrderReducer<T extends DaffOrder = DaffOrder>(\n  state = daffOrderInitialState,\n  action: DaffOrderActions<T>\n): DaffOrderReducerState {\n  switch (action.type) {\n    case DaffOrderActionTypes.OrderListAction:\n    case DaffOrderActionTypes.OrderLoadAction:\n      return {\n        ...state,\n        loading: true\n      };\n\n    case DaffOrderActionTypes.OrderListSuccessAction:\n    case DaffOrderActionTypes.OrderLoadSuccessAction:\n      return {\n        ...state,\n        loading: false,\n        errors: []\n      };\n\n    case DaffOrderActionTypes.OrderListFailureAction:\n    case DaffOrderActionTypes.OrderLoadFailureAction:\n      return {\n        ...state,\n        errors: [\n          ...state.errors,\n          action.payload\n        ],\n        loading: false\n      }\n\n    default:\n      return state;\n  }\n}\n","import { EntityAdapter, createEntityAdapter } from '@ngrx/entity';\n\nimport { DaffOrder } from '@daffodil/order';\n\n/**\n * Order Adapter for changing/overwriting entity state.\n */\nexport const daffGetOrderAdapter = (() => {\n  let cache;\n  return <T extends DaffOrder = DaffOrder>(): EntityAdapter<T> =>\n    cache = cache || createEntityAdapter<T>();\n})();\n","import { daffGetOrderAdapter } from './order-entities-adapter';\nimport { DaffOrderEntityState } from './order-entities-state.interface';\n\n/**\n * Initial state for order entity state.\n */\nexport const daffOrderEntitiesInitialState: DaffOrderEntityState<any> = daffGetOrderAdapter().getInitialState();\n","import { DaffOrder } from '@daffodil/order';\n\nimport { DaffOrderActions, DaffOrderActionTypes } from '../../actions/order.actions';\nimport { daffGetOrderAdapter } from './order-entities-adapter';\nimport { DaffOrderEntityState } from './order-entities-state.interface';\nimport { daffOrderEntitiesInitialState } from './order-entities-initial-state';\n\n/**\n * Reducer function that catches actions and changes/overwrites order entities state.\n */\nexport function daffOrderEntitiesReducer<T extends DaffOrder = DaffOrder>(\n  state = daffOrderEntitiesInitialState,\n  action: DaffOrderActions<T>\n): DaffOrderEntityState<T> {\n  const adapter = daffGetOrderAdapter<T>();\n\n  switch (action.type) {\n    case DaffOrderActionTypes.OrderLoadSuccessAction:\n      return adapter.upsertOne(action.payload, state);\n\n    case DaffOrderActionTypes.OrderListSuccessAction:\n      return adapter.upsertMany(action.payload, state);\n\n    default:\n      return state;\n  }\n}\n","import { ActionReducerMap } from '@ngrx/store';\n\nimport { daffOrderReducer } from './order/order.reducer';\nimport { DaffOrderReducersState } from './order-reducers.interface';\nimport { daffOrderEntitiesReducer } from './order-entities/public_api';\n\nexport const daffOrderReducers: ActionReducerMap<DaffOrderReducersState> = {\n  order: daffOrderReducer,\n  orders: daffOrderEntitiesReducer\n}\n","export const DAFF_ORDER_STORE_FEATURE_KEY = 'daffOrder';\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\n\nimport { DaffOrder } from '@daffodil/order';\n\nimport { DaffOrderReducersState, DAFF_ORDER_STORE_FEATURE_KEY } from '../reducers/public_api';\n\nexport interface DaffOrderFeatureSelector<T extends DaffOrder = DaffOrder> {\n  selectOrderFeatureState: MemoizedSelector<object, DaffOrderReducersState<T>>\n}\n\nexport const getDaffOrderReducersStateSelector = (() => {\n  let cache;\n  return <T extends DaffOrder = DaffOrder>(): DaffOrderFeatureSelector<T> =>\n    cache = cache || {\n      selectOrderFeatureState: createFeatureSelector<DaffOrderReducersState<T>>(DAFF_ORDER_STORE_FEATURE_KEY)\n    }\n})();\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Dictionary } from '@ngrx/entity';\n\nimport { DaffOrder, DaffOrderItem, DaffOrderTotal, DaffOrderTotalTypeEnum } from '@daffodil/order';\nimport { getDaffCartSelectors } from '@daffodil/cart/state';\n\nimport {\n  daffGetOrderAdapter,\n  DaffOrderEntityState\n} from '../reducers/public_api';\nimport { getDaffOrderReducersStateSelector } from './order-feature.selector';\n\nexport interface DaffOrderEntitySelectors<T extends DaffOrder = DaffOrder> {\n  selectOrderEntitiesState: MemoizedSelector<object, DaffOrderEntityState<T>>;\n  /**\n   * Selector for order IDs.\n   */\n  selectOrderIds: MemoizedSelector<object, string[] | number[]>;\n  /**\n   * Selector for order entities.\n   */\n  selectOrderEntities: MemoizedSelector<object, Dictionary<T>>;\n  /**\n   * Selector for all orders.\n   */\n  selectAllOrders: MemoizedSelector<object, T[]>;\n  /**\n   * Selector for total number of orders.\n   */\n  selectOrderTotal: MemoizedSelector<object, number>;\n  selectOrder: MemoizedSelector<object, T>;\n\n  /**\n   * Selector for the most recently placed order (if any).\n   */\n  selectPlacedOrder: MemoizedSelector<object, T>;\n  /**\n   * Selector for the existence of the most recently placed order.\n   */\n  selectHasPlacedOrder: MemoizedSelector<object, boolean>;\n\n  /**\n   * Selects the specified order's totals.\n   */\n  selectOrderTotals: MemoizedSelector<object, T['totals']>;\n  /**\n   * Selects the specified order's applied coupon codes.\n   */\n  selectOrderAppliedCodes: MemoizedSelector<object, T['applied_codes']>;\n  /**\n   * Selects the specified order's items.\n   */\n  selectOrderItems: MemoizedSelector<object, T['items']>;\n  /**\n   * Selects the specified order's billing addresses.\n   */\n  selectOrderBillingAddresses: MemoizedSelector<object, T['billing_addresses']>;\n  /**\n   * Selects the specified order's shipping addresses.\n   */\n  selectOrderShippingTotalAddresses: MemoizedSelector<object, T['shipping_addresses']>;\n  /**\n   * Selects the specified order's shipments.\n   */\n  selectOrderShipments: MemoizedSelector<object, T['shipments']>;\n  /**\n   * Selects the specified order's payment.\n   */\n  selectOrderPayment: MemoizedSelector<object, T['payment']>;\n  /**\n   * Selects the specified order's invoices.\n   */\n  selectOrderInvoices: MemoizedSelector<object, T['invoices']>;\n  /**\n   * Selects the specified order's credits.\n   */\n  selectOrderCredits: MemoizedSelector<object, T['credits']>;\n\n  /**\n   * Selects the specified order's specified item.\n   */\n  selectOrderItem: MemoizedSelector<object, DaffOrderItem>;\n\n  /**\n   * Selects the specified order's grand total.\n   */\n  selectOrderGrandTotal: MemoizedSelector<object, DaffOrderTotal>;\n  /**\n   * Selects the specified order's subtotal.\n   */\n  selectOrderSubtotal: MemoizedSelector<object, DaffOrderTotal>;\n  /**\n   * Selects the specified order's shipping total.\n   */\n  selectOrderShippingTotal: MemoizedSelector<object, DaffOrderTotal>;\n  /**\n   * Selects the specified order's discount total.\n   */\n\tselectOrderDiscountTotal: MemoizedSelector<object, DaffOrderTotal>;\n\t/**\n\t * Selects whether the specified order has a discount.\n\t */\n\tselectOrderHasDiscount: MemoizedSelector<object, boolean>;\n  /**\n   * Selects the specified order's tax total.\n   */\n  selectOrderTaxTotal: MemoizedSelector<object, DaffOrderTotal>;\n}\n\nconst createOrderEntitySelectors = <T extends DaffOrder = DaffOrder>() => {\n  const { selectOrderFeatureState } = getDaffOrderReducersStateSelector<T>();\n  const selectOrderEntitiesState = createSelector(\n    selectOrderFeatureState,\n    state => state.orders\n  )\n  const { selectIds, selectEntities, selectAll, selectTotal } = daffGetOrderAdapter<T>().getSelectors(selectOrderEntitiesState);\n  const { selectCartOrderId } = getDaffCartSelectors();\n\n  const selectOrder = createSelector(\n    selectEntities,\n    (orders, props) => orders[props.id] || null\n  )\n\n  const selectPlacedOrder = createSelector(\n    selectEntities,\n    selectCartOrderId,\n    (orders, orderId) => orderId ? selectOrder.projector(orders, {id: orderId}) : null\n  )\n  const selectHasPlacedOrder = createSelector(\n    selectPlacedOrder,\n    placedOrder => !!placedOrder\n  )\n\n  const selectOrderTotals = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const order: DaffOrder = selectOrder.projector(orders, {id: props.id});\n      return (order && order.totals) || []\n    }\n  );\n  const selectOrderAppliedCodes = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const order = selectOrder.projector(orders, {id: props.id});\n      return (order && order.applied_codes) || []\n    }\n  );\n  const selectOrderItems = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const order = selectOrder.projector(orders, {id: props.id});\n      return (order && order.items) || []\n    }\n  );\n  const selectOrderBillingAddresses = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const order = selectOrder.projector(orders, {id: props.id});\n      return (order && order.billing_addresses) || []\n    }\n  );\n  const selectOrderShippingTotalAddresses = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const order = selectOrder.projector(orders, {id: props.id});\n      return (order && order.shipping_addresses) || []\n    }\n  );\n  const selectOrderShipments = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const order = selectOrder.projector(orders, {id: props.id});\n      return (order && order.shipments) || []\n    }\n  );\n  const selectOrderPayment = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const order = selectOrder.projector(orders, {id: props.id});\n      return (order && order.payment) || null\n    }\n  );\n  const selectOrderInvoices = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const order = selectOrder.projector(orders, {id: props.id});\n      return (order && order.invoices) || []\n    }\n  );\n  const selectOrderCredits = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const order = selectOrder.projector(orders, {id: props.id});\n      return (order && order.credits) || []\n    }\n  );\n\n  const selectOrderGrandTotal = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const totals = selectOrderTotals.projector(orders, {id: props.id});\n      const index = totals.findIndex(total => total.type === DaffOrderTotalTypeEnum.GrandTotal);\n\n      return index > -1 ? totals[index] : null\n    }\n  );\n  const selectOrderSubtotal = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const totals = selectOrderTotals.projector(orders, { id: props.id });\n      const index = totals.findIndex(total => total.type === DaffOrderTotalTypeEnum.Subtotal);\n\n      return index > -1 ? totals[index] : null\n    }\n  );\n  const selectOrderShippingTotal = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const totals = selectOrderTotals.projector(orders, { id: props.id });\n      const index = totals.findIndex(total => total.type === DaffOrderTotalTypeEnum.Shipping);\n\n      return index > -1 ? totals[index] : null\n    }\n  );\n  const selectOrderDiscountTotal = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const totals = selectOrderTotals.projector(orders, { id: props.id });\n      const index = totals.findIndex(total => total.type === DaffOrderTotalTypeEnum.Discount);\n\n      return index > -1 ? totals[index] : null\n    }\n  );\n  const selectOrderHasDiscount = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const discountTotal = selectOrderDiscountTotal.projector(orders, { id: props.id });\n\n\t\t\t//todo: use optional chaining when possible\n      return !!discountTotal && discountTotal.value > 0;\n    }\n  );\n  const selectOrderTaxTotal = createSelector(\n    selectEntities,\n    (orders, props) => {\n      const totals = selectOrderTotals.projector(orders, { id: props.id });\n      const index = totals.findIndex(total => total.type === DaffOrderTotalTypeEnum.Tax);\n\n      return index > -1 ? totals[index] : null\n    }\n  );\n\n  const selectOrderItem = createSelector(\n\t\tselectEntities,\n\t\t(orders, props) => selectOrderItems.projector(orders, {id: props.id}).find(item => item.item_id === props.item_id) || null\n  );\n\n  return {\n    selectOrderEntitiesState,\n    selectOrderIds: selectIds,\n    selectOrderEntities: selectEntities,\n    selectAllOrders: selectAll,\n    selectOrderTotal: selectTotal,\n\n    selectPlacedOrder,\n    selectHasPlacedOrder,\n\n    selectOrder,\n    selectOrderTotals,\n    selectOrderAppliedCodes,\n    selectOrderItems,\n    selectOrderBillingAddresses,\n    selectOrderShippingTotalAddresses,\n    selectOrderShipments,\n    selectOrderPayment,\n    selectOrderInvoices,\n    selectOrderCredits,\n    selectOrderItem,\n\n    selectOrderGrandTotal,\n    selectOrderSubtotal,\n    selectOrderShippingTotal,\n    selectOrderDiscountTotal,\n    selectOrderHasDiscount,\n    selectOrderTaxTotal,\n  }\n}\n\nexport const getDaffOrderEntitySelectors = (() => {\n  let cache;\n  return <T extends DaffOrder = DaffOrder>(): DaffOrderEntitySelectors<T> =>\n    cache = cache || createOrderEntitySelectors<T>()\n})();\n\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\n\nimport { DaffOrder } from '@daffodil/order';\n\nimport { getDaffOrderReducersStateSelector } from './order-feature.selector';\nimport {\n  DaffOrderReducerState,\n} from '../reducers/public_api';\n\nexport interface DaffOrderSelectors {\n  selectOrderState: MemoizedSelector<object, DaffOrderReducerState>;\n  selectOrderLoading: MemoizedSelector<object, boolean>;\n  selectOrderErrors: MemoizedSelector<object, string[]>;\n}\n\nconst createOrderSelectors = <T extends DaffOrder = DaffOrder>() => {\n  const { selectOrderFeatureState } = getDaffOrderReducersStateSelector<T>();\n  const selectOrderState = createSelector(\n    selectOrderFeatureState,\n    state => state.order\n  );\n\n  const selectOrderLoading = createSelector(\n    selectOrderState,\n    state => state.loading\n  );\n\n  const selectOrderErrors = createSelector(\n    selectOrderState,\n    state => state.errors\n  );\n\n  return {\n    selectOrderState,\n    selectOrderLoading,\n    selectOrderErrors\n  }\n}\n\nexport const getOrderSelectors = (() => {\n  let cache;\n  return <T extends DaffOrder = DaffOrder>(): DaffOrderSelectors =>\n    cache = cache || createOrderSelectors<T>()\n})();\n","import { DaffOrder } from '@daffodil/order';\n\nimport { DaffOrderEntitySelectors, getDaffOrderEntitySelectors } from './order-entities.selector';\nimport { DaffOrderSelectors, getOrderSelectors } from './order.selector';\nimport { DaffOrderFeatureSelector, getDaffOrderReducersStateSelector } from './order-feature.selector';\n\nexport interface DaffOrderAllSelectors<T extends DaffOrder = DaffOrder> extends\n  DaffOrderEntitySelectors<T>,\n  DaffOrderSelectors,\n  DaffOrderFeatureSelector<T> {}\n\nexport const getDaffOrderSelectors = (() => {\n  let cache;\n  return <T extends DaffOrder = DaffOrder>(): DaffOrderAllSelectors<T> =>\n    cache = cache || {\n      ...getOrderSelectors<T>(),\n      ...getDaffOrderEntitySelectors<T>(),\n      ...getDaffOrderReducersStateSelector<T>()\n    }\n})();\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Action, Store, select } from '@ngrx/store';\nimport { Dictionary } from '@ngrx/entity';\n\nimport { DaffOrder, DaffOrderTotal } from '@daffodil/order';\n\nimport { DaffOrderReducersState } from '../../reducers/public_api';\nimport {\n  getDaffOrderSelectors\n} from '../../selectors/public_api';\nimport { DaffOrderFacadeInterface } from './order-facade.interface';\nimport { DaffOrderEntitySelectors } from '../../selectors/order-entities.selector';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DaffOrderFacade<T extends DaffOrder = DaffOrder> implements DaffOrderFacadeInterface<T> {\n  loading$: Observable<boolean>;\n  errors$: Observable<string[]>;\n\n  orders$: Observable<T[]>;\n  orderIds$: Observable<(string | number)[]>;\n  orderCount$: Observable<number>;\n  orderEntities$: Observable<Dictionary<T>>;\n\n  placedOrder$: Observable<T>;\n  hasPlacedOrder$: Observable<boolean>;\n\n  _order: DaffOrderEntitySelectors<T>['selectOrder'];\n  _totals: DaffOrderEntitySelectors<T>['selectOrderTotals'];\n  _appliedCodes: DaffOrderEntitySelectors<T>['selectOrderAppliedCodes'];\n  _items: DaffOrderEntitySelectors<T>['selectOrderItems'];\n  _billingAddresses: DaffOrderEntitySelectors<T>['selectOrderBillingAddresses'];\n  _shippingAddresses: DaffOrderEntitySelectors<T>['selectOrderShippingTotalAddresses'];\n  _shipments: DaffOrderEntitySelectors<T>['selectOrderShipments'];\n  _payment: DaffOrderEntitySelectors<T>['selectOrderPayment'];\n  _invoices: DaffOrderEntitySelectors<T>['selectOrderInvoices'];\n  _credits: DaffOrderEntitySelectors<T>['selectOrderCredits'];\n  _grandTotal: DaffOrderEntitySelectors<T>['selectOrderGrandTotal'];\n  _subtotal: DaffOrderEntitySelectors<T>['selectOrderSubtotal'];\n  _shipping: DaffOrderEntitySelectors<T>['selectOrderShippingTotal'];\n  _discount: DaffOrderEntitySelectors<T>['selectOrderDiscountTotal'];\n  _hasDiscount: DaffOrderEntitySelectors<T>['selectOrderHasDiscount'];\n  _tax: DaffOrderEntitySelectors<T>['selectOrderTaxTotal'];\n\n  constructor(private store: Store<DaffOrderReducersState<T>>) {\n    const {\n      selectOrderIds,\n      selectOrderEntities,\n      selectAllOrders,\n      selectOrderTotal,\n      selectOrderLoading,\n      selectOrderErrors,\n\n      selectPlacedOrder,\n      selectHasPlacedOrder,\n\n      selectOrder,\n      selectOrderTotals,\n      selectOrderAppliedCodes,\n      selectOrderItems,\n      selectOrderBillingAddresses,\n      selectOrderShippingTotalAddresses,\n      selectOrderShipments,\n      selectOrderPayment,\n      selectOrderInvoices,\n      selectOrderCredits,\n\n      selectOrderGrandTotal,\n      selectOrderSubtotal,\n      selectOrderShippingTotal,\n      selectOrderDiscountTotal,\n      selectOrderHasDiscount,\n      selectOrderTaxTotal,\n    } = getDaffOrderSelectors<T>();\n\n    this.loading$ = this.store.pipe(select(selectOrderLoading));\n    this.errors$ = this.store.pipe(select(selectOrderErrors));\n\n    this.orders$ = this.store.pipe(select(selectAllOrders));\n    this.orderIds$ = this.store.pipe(select(selectOrderIds));\n    this.orderCount$ = this.store.pipe(select(selectOrderTotal));\n    this.orderEntities$ = this.store.pipe(select(selectOrderEntities));\n\n    this.placedOrder$ = this.store.pipe(select(selectPlacedOrder));\n    this.hasPlacedOrder$ = this.store.pipe(select(selectHasPlacedOrder));\n\n    this._order = selectOrder;\n    this._totals = selectOrderTotals;\n    this._appliedCodes = selectOrderAppliedCodes;\n    this._items = selectOrderItems;\n    this._billingAddresses = selectOrderBillingAddresses;\n    this._shippingAddresses = selectOrderShippingTotalAddresses;\n    this._shipments = selectOrderShipments;\n    this._payment = selectOrderPayment;\n    this._invoices = selectOrderInvoices;\n    this._credits = selectOrderCredits;\n    this._grandTotal = selectOrderGrandTotal;\n    this._subtotal = selectOrderSubtotal;\n    this._shipping = selectOrderShippingTotal;\n    this._discount = selectOrderDiscountTotal;\n    this._hasDiscount = selectOrderHasDiscount;\n    this._tax = selectOrderTaxTotal;\n  }\n\n  getOrder$(orderId: T['id']): Observable<T> {\n    return this.store.pipe(select(this._order, {id: orderId}))\n  }\n\n  getTotals$(orderId: T['id']): Observable<T['totals']> {\n    return this.store.pipe(select(this._totals, {id: orderId}))\n  }\n\n  getAppliedCodes$(orderId: T['id']): Observable<T['applied_codes']> {\n    return this.store.pipe(select(this._appliedCodes, {id: orderId}))\n  }\n\n  getItems$(orderId: T['id']): Observable<T['items']> {\n    return this.store.pipe(select(this._items, {id: orderId}))\n  }\n\n  getBillingAddresses$(orderId: T['id']): Observable<T['billing_addresses']> {\n    return this.store.pipe(select(this._billingAddresses, {id: orderId}))\n  }\n\n  getShippingAddresses$(orderId: T['id']): Observable<T['shipping_addresses']> {\n    return this.store.pipe(select(this._shippingAddresses, {id: orderId}))\n  }\n\n  getShipments$(orderId: T['id']): Observable<T['shipments']> {\n    return this.store.pipe(select(this._shipments, {id: orderId}))\n  }\n\n  getPayment$(orderId: T['id']): Observable<T['payment']> {\n    return this.store.pipe(select(this._payment, {id: orderId}))\n  }\n\n  getInvoices$(orderId: T['id']): Observable<T['invoices']> {\n    return this.store.pipe(select(this._invoices, {id: orderId}))\n  }\n\n  getCredits$(orderId: T['id']): Observable<T['credits']> {\n    return this.store.pipe(select(this._credits, {id: orderId}))\n  }\n\n  getGrandTotal$(orderId: T['id']): Observable<DaffOrderTotal> {\n    return this.store.pipe(select(this._grandTotal, {id: orderId}))\n  };\n  getSubtotal$(orderId: T['id']): Observable<DaffOrderTotal> {\n    return this.store.pipe(select(this._subtotal, {id: orderId}))\n  };\n  getShippingTotal$(orderId: T['id']): Observable<DaffOrderTotal> {\n    return this.store.pipe(select(this._shipping, {id: orderId}))\n  };\n  getDiscountTotal$(orderId: T['id']): Observable<DaffOrderTotal> {\n    return this.store.pipe(select(this._discount, {id: orderId}))\n  };\n  hasDiscount$(orderId: T['id']): Observable<boolean> {\n    return this.store.pipe(select(this._hasDiscount, {id: orderId}))\n  };\n  getTaxTotal$(orderId: T['id']): Observable<DaffOrderTotal> {\n    return this.store.pipe(select(this._tax, {id: orderId}))\n  };\n\n  dispatch(action: Action) {\n    this.store.dispatch(action);\n  }\n}\n","import { InjectionToken } from '@angular/core';\n\nexport const DaffPlacedOrderGuardRedirectUrl = new InjectionToken<string>('DaffPlacedOrderGuardRedirectUrl');\n","import { CanActivate, Router } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { Injectable, Inject } from '@angular/core';\nimport { tap } from 'rxjs/operators';\n\nimport { DaffOrderFacade } from '../../facades/order/order.facade';\nimport { DaffPlacedOrderGuardRedirectUrl } from './placed-order-guard-redirect.token';\n\n/**\n * A routing guard that will redirect to a given url if the placed order is not defined.\n * The url is `/` by default, but can be overridden with the DaffPlacedOrderGuardRedirectUrl injection token.\n */\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class DaffPlacedOrderGuard implements CanActivate {\n  constructor(\n\t\tprivate facade: DaffOrderFacade,\n\t\tprivate router: Router,\n\t\t@Inject(DaffPlacedOrderGuardRedirectUrl) private redirectUrl: string\n\t) {}\n\n  canActivate(): Observable<boolean> {\n    return this.facade.hasPlacedOrder$.pipe(\n\t\t\ttap(hasPlacedOrder => {\n\t\t\t\tif (!hasPlacedOrder) {\n\t\t\t\t\tthis.router.navigateByUrl(this.redirectUrl)\n\t\t\t\t}\n\t\t\t})\n\t\t)\n  }\n}\n","import { Injectable, Inject } from '@angular/core';\nimport { switchMap, map, catchError } from 'rxjs/operators';\nimport { of } from 'rxjs';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\n\nimport {\n  DaffCart\n} from '@daffodil/cart';\nimport {\n  DaffOrder,\n} from '@daffodil/order';\nimport {\n  DaffOrderServiceInterface,\n  DaffOrderDriver\n} from '@daffodil/order/driver';\n\nimport {\n  DaffOrderActionTypes,\n  DaffOrderLoad,\n  DaffOrderLoadSuccess,\n  DaffOrderLoadFailure,\n  DaffOrderList,\n  DaffOrderListSuccess,\n  DaffOrderListFailure,\n} from '../actions/order.actions';\n\n@Injectable()\nexport class DaffOrderEffects<\n  T extends DaffOrder = DaffOrder,\n  V extends DaffCart = DaffCart\n> {\n  constructor(\n    private actions$: Actions,\n    @Inject(DaffOrderDriver) private driver: DaffOrderServiceInterface<T>,\n  ) {}\n\n  /**\n   * An effect for the loading of an order.\n   */\n  @Effect()\n  get$ = this.actions$.pipe(\n    ofType(DaffOrderActionTypes.OrderLoadAction),\n    switchMap((action: DaffOrderLoad<T, V>) =>\n      this.driver.get(action.orderId, action.cartId).pipe(\n        map(resp => new DaffOrderLoadSuccess<T>(resp)),\n        catchError(error => of(new DaffOrderLoadFailure('Failed to load order')))\n      )\n    ),\n  )\n\n  /**\n   * An effect for the listing of orders.\n   */\n  @Effect()\n  list$ = this.actions$.pipe(\n    ofType(DaffOrderActionTypes.OrderListAction),\n    switchMap((action: DaffOrderList) =>\n      this.driver.list(action.payload).pipe(\n        map(resp => new DaffOrderListSuccess<T>(resp)),\n        catchError(error => of(new DaffOrderListFailure('Failed to list the orders')))\n      )\n    ),\n  )\n}\n","import { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\n\nimport { DAFF_ORDER_STORE_FEATURE_KEY, daffOrderReducers } from './reducers/public_api';\nimport { DaffOrderEffects } from './effects/order.effects';\nimport { DaffPlacedOrderGuardRedirectUrl } from './guards/public_api';\n\n@NgModule({\n  imports: [\n    EffectsModule.forFeature([\n      DaffOrderEffects,\n    ]),\n    StoreModule.forFeature(DAFF_ORDER_STORE_FEATURE_KEY, daffOrderReducers),\n  ],\n  providers: [\n\t\t{ provide: DaffPlacedOrderGuardRedirectUrl, useValue: '/' },\n  ]\n})\nexport class DaffOrderStateModule {}\n"],"names":["createEntityAdapter","createFeatureSelector","createSelector","DaffOrderTotalTypeEnum","store","select","Injectable","Store","InjectionToken","tap","Router","Inject","ofType","switchMap","map","catchError","of","Actions","DaffOrderDriver","Effect","NgModule","EffectsModule","StoreModule"],"mappings":"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"}
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@daffodil/order"),require("graphql-tag"),require("@daffodil/core/graphql"),require("@angular/core"),require("apollo-angular"),require("rxjs"),require("rxjs/operators"),require("@daffodil/order/driver"),require("@daffodil/driver/magento"),require("@daffodil/cart/driver"),require("@angular/common")):"function"==typeof define&&define.amd?define("@daffodil/order/driver/magento/2.4.0",["exports","@daffodil/order","graphql-tag","@daffodil/core/graphql","@angular/core","apollo-angular","rxjs","rxjs/operators","@daffodil/order/driver","@daffodil/driver/magento","@daffodil/cart/driver","@angular/common"],r):r(((e=e||self).daffodil=e.daffodil||{},e.daffodil.order=e.daffodil.order||{},e.daffodil.order.driver=e.daffodil.order.driver||{},e.daffodil.order.driver.magento=e.daffodil.order.driver.magento||{},e.daffodil.order.driver.magento[2]=e.daffodil.order.driver.magento[2]||{},e.daffodil.order.driver.magento[2][4]=e.daffodil.order.driver.magento[2][4]||{},e.daffodil.order.driver.magento[2][4][0]={}),e.daffodil.order,e.gql,e.graphql,e.ng.core,e.apolloAngular,e.rxjs,e.rxjs.operators,e.daffodil.order.driver,e.magento,e.driver$1,e.ng.common)}(this,function(e,r,n,t,o,a,d,i,c,s,l,u){"use strict";function m(e){return[{label:"Grand Total",type:r.DaffOrderTotalTypeEnum.GrandTotal,value:e.grand_total,sort_order:1},{label:"Subtotal",type:r.DaffOrderTotalTypeEnum.Subtotal,value:e.subtotal,sort_order:0},{label:"Shipping",type:r.DaffOrderTotalTypeEnum.Shipping,value:e.shipping,sort_order:2},{label:"Tax",type:r.DaffOrderTotalTypeEnum.Tax,value:e.tax,sort_order:3},{label:"Discount",type:r.DaffOrderTotalTypeEnum.Discount,value:e.discount,sort_order:4}]}function p(e){return{item_id:null,type:r.DaffOrderItemType.Simple,qty_ordered:e.qty_ordered,qty_canceled:e.qty_canceled,qty_fulfilled:e.qty_fulfilled,qty:e.qty,image:{url:e.image,id:null,label:null},order_id:Number(e.order_id),created_at:e.created_at,updated_at:e.updated_at,product_id:e.product_id,parent_item_id:null,sku:e.sku,name:e.name,weight:e.weight,price:e.price,discount_percent:e.discount_percent,discount_amount:e.discount_amount,tax_percent:e.tax_percent,tax_amount:e.tax_amount,row_total:e.row_total,row_total_with_discount:e.row_total_with_discount,row_weight:e.row_weight,tax_before_discount:e.tax_before_discount}}function f(e){return{order_id:e.order_id,prefix:e.prefix,suffix:e.suffix,firstname:e.firstname,middlename:e.middlename,lastname:e.lastname,telephone:e.telephone,email:e.email,street:e.street[0],street2:e.street[1],city:e.city,region:e.region_id,country:e.country_code,postcode:e.postcode}}function _(e){return{item:p(e.item),qty:e.qty}}function g(e){return{tracking_number:e.tracking_number,tracking_url:null,carrier:e.carrier,title:e.title,carrier_logo:null}}function y(e){return{carrier:null,carrier_title:null,code:null,method:null,method_description:null,tracking:e.tracking.map(g),items:e.items.map(_)}}function h(e){return{payment_id:e.payment_id,order_id:e.order_id,created_at:null,updated_at:null,method:e.method,cc_type:e.cc_type,cc_last4:e.cc_last4,cc_owner:e.cc_owner,cc_exp_month:e.cc_exp_month,cc_exp_year:e.cc_exp_year}}function v(e){return{totals:m(e),billing_address:f(e.billing_address),shipping_address:f(e.shipping_address),payment:h(e.payment),items:e.items.map(_),shipping_method:null}}function b(e){return{extra_attributes:e,id:e.order_number,customer_id:e.customer_id,created_at:e.created_at,updated_at:e.updated_at,status:e.status,totals:m(e),applied_codes:e.applied_codes.map(function(e){return{code:e}}),items:e.items.map(p),billing_addresses:[f(e.billing_address)],shipping_addresses:[f(e.shipping_address)],shipments:e.shipments.map(y),payment:h(e.payment),invoices:e.invoices.map(v),credits:e.credits.map(v)}}n=n&&n.hasOwnProperty("default")?n.default:n;var O,w,x,I,q,j,S,T,P,k,G=this&&this.__makeTemplateObject||function(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e},D=n(O||(O=G(["\n  fragment orderItem on GraycoreOrderItem {\n    qty_ordered\n    image\n    qty_canceled\n    qty_fulfilled\n    order_id\n    created_at\n    updated_at\n    product_id\n    sku\n    name\n    weight\n    qty\n    price\n    discount_percent\n    discount_amount\n    tax_percent\n    tax_amount\n    row_total\n    row_total_with_discount\n    row_weight\n    tax_before_discount\n  }\n"],["\n  fragment orderItem on GraycoreOrderItem {\n    qty_ordered\n    image\n    qty_canceled\n    qty_fulfilled\n    order_id\n    created_at\n    updated_at\n    product_id\n    sku\n    name\n    weight\n    qty\n    price\n    discount_percent\n    discount_amount\n    tax_percent\n    tax_amount\n    row_total\n    row_total_with_discount\n    row_weight\n    tax_before_discount\n  }\n"]))),A=this&&this.__makeTemplateObject||function(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e},F=n(w||(w=A(["\n  fragment orderAddress on GraycoreOrderAddress {\n    order_id\n    prefix\n    suffix\n    firstname\n    middlename\n    lastname\n    telephone\n    email\n    street\n    city\n    region\n    region_id\n    country_code\n    postcode\n  }\n"],["\n  fragment orderAddress on GraycoreOrderAddress {\n    order_id\n    prefix\n    suffix\n    firstname\n    middlename\n    lastname\n    telephone\n    email\n    street\n    city\n    region\n    region_id\n    country_code\n    postcode\n  }\n"]))),E=this&&this.__makeTemplateObject||function(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e},M=n(x||(x=E(["\n  fragment orderShipmentItem on GraycoreOrderShipmentItem {\n    qty\n    item {\n      ...orderItem\n    }\n  }\n  ","\n"],["\n  fragment orderShipmentItem on GraycoreOrderShipmentItem {\n    qty\n    item {\n      ...orderItem\n    }\n  }\n  ","\n"])),D),N=this&&this.__makeTemplateObject||function(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e},$=n(I||(I=N(["\n  fragment orderShipmentTracking on GraycoreOrderShipmentTracking {\n    tracking_number\n    carrier\n    title\n  }\n"],["\n  fragment orderShipmentTracking on GraycoreOrderShipmentTracking {\n    tracking_number\n    carrier\n    title\n  }\n"]))),C=this&&this.__makeTemplateObject||function(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e},R=n(q||(q=C(["\n  fragment orderShipment on GraycoreOrderShipment {\n    tracking {\n      ...orderShipmentTracking\n    }\n    items {\n      ...orderShipmentItem\n    }\n  }\n  ","\n  ","\n"],["\n  fragment orderShipment on GraycoreOrderShipment {\n    tracking {\n      ...orderShipmentTracking\n    }\n    items {\n      ...orderShipmentItem\n    }\n  }\n  ","\n  ","\n"])),M,$),B=this&&this.__makeTemplateObject||function(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e},z=n(j||(j=B(["\n  fragment orderPayment on GraycoreOrderPayment {\n    payment_id\n    order_id\n    method\n    cc_type\n    cc_last4\n    cc_owner\n    cc_exp_month\n    cc_exp_year\n  }\n"],["\n  fragment orderPayment on GraycoreOrderPayment {\n    payment_id\n    order_id\n    method\n    cc_type\n    cc_last4\n    cc_owner\n    cc_exp_month\n    cc_exp_year\n  }\n"]))),H=this&&this.__makeTemplateObject||function(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e},J=n(S||(S=H(["\n  fragment orderInvoice on GraycoreOrderInvoice {\n    items {\n      ...orderShipmentItem\n    }\n    grand_total\n    subtotal\n    shipping\n    discount\n    tax\n    billing_address {\n      ...orderAddress\n    }\n    shipping_address {\n      ...orderAddress\n\t\t}\n\t\tpayment {\n\t\t\t...orderPayment\n\t\t}\n  }\n  ","\n  ","\n  ","\n"],["\n  fragment orderInvoice on GraycoreOrderInvoice {\n    items {\n      ...orderShipmentItem\n    }\n    grand_total\n    subtotal\n    shipping\n    discount\n    tax\n    billing_address {\n      ...orderAddress\n    }\n    shipping_address {\n      ...orderAddress\n\t\t}\n\t\tpayment {\n\t\t\t...orderPayment\n\t\t}\n  }\n  ","\n  ","\n  ","\n"])),M,F,z),K=this&&this.__makeTemplateObject||function(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e},L=n(T||(T=K(["\n  fragment order on GraycoreOrder {\n    id\n    order_number\n    customer_id\n    created_at\n    updated_at\n    grand_total\n    subtotal\n    shipping\n    discount\n    tax\n    status\n    applied_codes\n    items {\n      ...orderItem\n    }\n    billing_address {\n      ...orderAddress\n    }\n    shipping_address {\n      ...orderAddress\n    }\n    shipments {\n      ...orderShipment\n    }\n    payment {\n      ...orderPayment\n    }\n    invoices {\n      ...orderInvoice\n    }\n    credits {\n      ...orderInvoice\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n"],["\n  fragment order on GraycoreOrder {\n    id\n    order_number\n    customer_id\n    created_at\n    updated_at\n    grand_total\n    subtotal\n    shipping\n    discount\n    tax\n    status\n    applied_codes\n    items {\n      ...orderItem\n    }\n    billing_address {\n      ...orderAddress\n    }\n    shipping_address {\n      ...orderAddress\n    }\n    shipments {\n      ...orderShipment\n    }\n    payment {\n      ...orderPayment\n    }\n    invoices {\n      ...orderInvoice\n    }\n    credits {\n      ...orderInvoice\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n"])),D,R,z,J,F),Q=this&&this.__makeTemplateObject||function(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e},U=this&&this.__read||function(e,r){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var t,o,a=n.call(e),d=[];try{for(;(void 0===r||r-- >0)&&!(t=a.next()).done;)d.push(t.value)}catch(e){o={error:e}}finally{try{t&&!t.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return d},V=this&&this.__spread||function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(U(arguments[r]));return e},W=function(e){return void 0===e&&(e=[]),n(P||(P=Q(["\n  query GetGuestOrders($cartId: String!) {\n    graycoreGuestOrders(cartId: $cartId) {\n      orders {\n        ...order\n        ","\n      }\n    }\n  }\n  ","\n  ","\n"],["\n  query GetGuestOrders($cartId: String!) {\n    graycoreGuestOrders(cartId: $cartId) {\n      orders {\n        ...order\n        ","\n      }\n    }\n  }\n  ","\n  ","\n"])),t.daffBuildFragmentNameSpread.apply(void 0,V(e)),L,t.daffBuildFragmentDefinition.apply(void 0,V(e)))},X=new o.InjectionToken("DaffMagentoExtraOrderFragments",{factory:function(){return[]}}),Y=function(e){if(e.data.graycoreGuestOrders.orders){if(e.data.graycoreGuestOrders.orders.reduce(function(e,r){return e&&!!(r.billing_address&&r.shipping_address&&r.payment)},!0))return e;throw new c.DaffOrderInvalidAPIResponseError("One of the orders does not contain required fields.")}throw new c.DaffOrderInvalidAPIResponseError("Get orders response does not contain a valid list of orders.")},Z=((k={})["graphql-no-such-entity"]=l.DaffCartNotFoundError,k);var ee=this&&this.__values||function(e){var r="function"==typeof Symbol&&e[Symbol.iterator],n=0;return r?r.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},re=function(){function e(e,r){this.apollo=e,this.extraOrderFragments=r}return e.prototype.list=function(e){return this.apollo.query({query:W(this.extraOrderFragments),variables:{cartId:e}}).pipe(i.map(Y),i.map(function(e){return e.data.graycoreGuestOrders.orders.map(b)}),i.catchError(function(e){return d.throwError((r=e,s.daffTransformMagentoError(r,Z)));var r}))},e.prototype.get=function(e,r){return this.list(r).pipe(i.map(function(r){var n,t;try{for(var o=ee(r),a=o.next();!a.done;a=o.next()){var d=a.value;if(String(d.id)===String(e))return d}}catch(e){n={error:e}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}throw new c.DaffOrderNotFoundError("Could not find an order with ID "+e)}))},e.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:a.Apollo},{type:Array,decorators:[{type:o.Inject,args:[X]}]}]},e.ngInjectableDef=o.ɵɵdefineInjectable({factory:function(){return new e(o.ɵɵinject(a.Apollo),o.ɵɵinject(X))},token:e,providedIn:"root"}),e}();var ne=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[{provide:c.DaffOrderDriver,useExisting:re}]}},e.decorators=[{type:o.NgModule,args:[{imports:[u.CommonModule]}]}],e}();e.DaffMagentoExtraOrderFragments=X,e.DaffOrderMagentoDriverModule=ne,e.DaffOrderMagentoService=re,e.daffMagentoTransformOrder=b,e.getGuestOrders=W,e.orderAddressFragment=F,e.orderFragment=L,e.orderInvoiceFragment=J,e.orderItemFragment=D,e.orderPaymentFragment=z,e.orderShipmentFragment=R,e.orderShipmentItemFragment=M,e.orderShipmentTrackingFragment=$,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=daffodil-order-driver-magento-2.4.0.umd.min.js.map
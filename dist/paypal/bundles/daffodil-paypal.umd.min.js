!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("rxjs/operators"),require("apollo-angular"),require("graphql-tag"),require("rxjs"),require("@ngrx/effects"),require("@ngrx/store")):"function"==typeof define&&define.amd?define("@daffodil/paypal",["exports","@angular/core","@angular/common","rxjs/operators","apollo-angular","graphql-tag","rxjs","@ngrx/effects","@ngrx/store"],t):t(((e=e||self).daffodil=e.daffodil||{},e.daffodil.paypal={}),e.ng.core,e.ng.common,e.rxjs.operators,e.apolloAngular,e.gql,e.rxjs,e.effects,e.store)}(this,function(e,t,r,n,a,o,s,p,l){"use strict";o=o&&o.hasOwnProperty("default")?o.default:o;var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var c={GeneratePaypalExpressTokenAction:"[Daff Paypal] Generate Express Token Action",GeneratePaypalExpressTokenSuccessAction:"[Daff Paypal] Generate Express Token Success Action",GeneratePaypalExpressTokenFailureAction:"[Daff Paypal] Generate Express Token Failure Action"},u=function(e){this.payload=e,this.type=c.GeneratePaypalExpressTokenAction};var f=function(e){this.payload=e,this.type=c.GeneratePaypalExpressTokenSuccessAction};var y=function(e){this.payload=e,this.type=c.GeneratePaypalExpressTokenFailureAction};var d,g,P,k=new t.InjectionToken("DaffPaypalTransformer"),T=new t.InjectionToken("DaffPaypalDriver"),h=new t.InjectionToken("DaffPaypalConfig"),x=o(P||(d=["\n\tmutation GenerateToken($input: MagentoPaypalTokenRequest) {\n\t\tcreatePaypalExpressToken(input: $input) {\n\t\t\ttoken\n\t\t\tpaypal_urls {\n\t\t\t\tstart\n\t\t\t\tedit\n\t\t\t}\n\t\t}\n\t}\n"],g=["\n\tmutation GenerateToken($input: MagentoPaypalTokenRequest) {\n\t\tcreatePaypalExpressToken(input: $input) {\n\t\t\ttoken\n\t\t\tpaypal_urls {\n\t\t\t\tstart\n\t\t\t\tedit\n\t\t\t}\n\t\t}\n\t}\n"],Object.defineProperty?Object.defineProperty(d,"raw",{value:g}):d.raw=g,P=d)),v=function(){function e(e,t,r){this.apollo=e,this.transformer=t,this.config=r}return e.prototype.generateToken=function(e){var t=this;return this.apollo.mutate({mutation:x,variables:{input:this.transformer.transformOut(e,this.config)}}).pipe(n.map(function(e){return t.transformer.transformIn(e.data.createPaypalExpressToken)}))},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:a.Apollo},{type:void 0,decorators:[{type:t.Inject,args:[k]}]},{type:void 0,decorators:[{type:t.Inject,args:[h]}]}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(a.Apollo),t.ɵɵinject(k),t.ɵɵinject(h))},token:e,providedIn:"root"}),e}();var m=function(){function e(){}return e.prototype.transformOut=function(e,t){return{cart_id:e.cartId,code:t.code?t.code:"paypal_express",urls:{cancel_url:t.cancel_url,return_url:t.return_url,pending_url:t.pending_url,success_url:t.success_url},express_button:!!t.express_button&&t.express_button,use_paypal_credit:!!t.use_paypal_credit&&t.use_paypal_credit}},e.prototype.transformIn=function(e){return{token:e.token,urls:{start:e.paypal_urls.start,edit:e.paypal_urls.edit}}},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),j=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[{provide:T,useExisting:v},{provide:k,useExisting:m}]}},e.decorators=[{type:t.NgModule,args:[{imports:[r.CommonModule]}]}],e}(),E=function(){function e(e,t){var r=this;this.actions$=e,this.driver=t,this.generatePaypalExpressToken$=p.createEffect(function(){return r.actions$.pipe(p.ofType(c.GeneratePaypalExpressTokenAction),n.switchMap(function(e){return r.driver.generateToken(e.payload).pipe(n.map(function(e){return new f(e)}),n.catchError(function(e){return s.of(new y("Failed to retrieve token"))}))}))})}return e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:p.Actions},{type:void 0,decorators:[{type:t.Inject,args:[T]}]}]},e}();var D={paypalTokenResponse:null,loading:!1,error:null};function I(e,t){switch(void 0===e&&(e=D),t.type){case c.GeneratePaypalExpressTokenAction:return i({},e,{loading:!0});case c.GeneratePaypalExpressTokenSuccessAction:return i({},e,{paypalTokenResponse:t.payload,loading:!1,error:null});case c.GeneratePaypalExpressTokenFailureAction:return i({},e,{error:t.payload,loading:!1,paypalTokenResponse:null});default:return e}}var _={paypal:I},S=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[l.StoreModule.forFeature("paypal",_),p.EffectsModule.forFeature([E])]}]}],e}(),b=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[r.CommonModule,S]}]}],e}();var G,A=function(){var e=l.createFeatureSelector("paypal"),t=l.createSelector(e,function(e){return e.paypal}),r=l.createSelector(t,function(e){return e.paypalTokenResponse});return{selectPaypalFeatureState:e,selectPaypalState:t,selectPaypalTokenResponse:r,selectPaypalLoading:l.createSelector(t,function(e){return e.loading}),selectPaypalError:l.createSelector(t,function(e){return e.error}),selectPaypalToken:l.createSelector(r,function(e){return e.token}),selectPaypalStartUrl:l.createSelector(r,function(e){return e.urls.start}),selectPaypalEditUrl:l.createSelector(r,function(e){return e.urls.edit})}},M=function(){return G=G||A()},w=function(){function e(e){this.store=e;var t=M(),r=t.selectPaypalTokenResponse,n=t.selectPaypalToken,a=t.selectPaypalStartUrl,o=t.selectPaypalEditUrl,s=t.selectPaypalLoading,p=t.selectPaypalError;this.paypalTokenResponse$=this.store.pipe(l.select(r)),this.paypalToken$=this.store.pipe(l.select(n)),this.paypalStartUrl$=this.store.pipe(l.select(a)),this.paypalEditUrl$=this.store.pipe(l.select(o)),this.loading$=this.store.pipe(l.select(s)),this.error$=this.store.pipe(l.select(p))}return e.prototype.dispatch=function(e){this.store.dispatch(e)},e.decorators=[{type:t.Injectable,args:[{providedIn:b}]}],e.ctorParameters=function(){return[{type:l.Store}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(l.Store))},token:e,providedIn:b}),e}();e.DaffGeneratePaypalExpressToken=u,e.DaffGeneratePaypalExpressTokenFailure=y,e.DaffGeneratePaypalExpressTokenSuccess=f,e.DaffPaypalActionTypes=c,e.DaffPaypalConfig=h,e.DaffPaypalDriver=T,e.DaffPaypalEffects=E,e.DaffPaypalFacade=w,e.DaffPaypalMagentoDriverModule=j,e.DaffPaypalModule=b,e.DaffPaypalStateModule=S,e.DaffPaypalTransformer=k,e.GenerateTokenMutation=x,e.daffPaypalReducer=I,e.daffPaypalReducers=_,e.getDaffPaypalSelectors=M,e.ɵa=v,e.ɵc=m,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=daffodil-paypal.umd.min.js.map
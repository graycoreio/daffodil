!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@ngrx/store"),require("@angular/common"),require("@ngrx/effects"),require("rxjs/operators"),require("rxjs")):"function"==typeof define&&define.amd?define("@daffodil/checkout",["exports","@angular/core","@ngrx/store","@angular/common","@ngrx/effects","rxjs/operators","rxjs"],t):t(((e=e||self).daffodil=e.daffodil||{},e.daffodil.checkout={}),e.ng.core,e.store,e.ng.common,e.effects,e.rxjs.operators,e.rxjs)}(this,function(e,t,r,n,i,o,s){"use strict";var c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var p={UpdateShippingAddressAction:"[Shipping] Update Shipping Address Action",SelectShippingOptionAction:"[Shipping] Select Shipping Option Action"},d=function(e){this.payload=e,this.type=p.UpdateShippingAddressAction};var l=function(e){this.payload=e,this.type=p.SelectShippingOptionAction};var f=r.createFeatureSelector("shipping"),u=r.createSelector(f,function(e){return e.shipping}),g=r.createSelector(u,function(e){return e.shippingAddress}),h=r.createSelector(u,function(e){return e.selectedShippingOptionId}),y=r.createSelector(g,function(e){return!!e}),A=function(){function e(e){this.store=e}return e.prototype.ngOnInit=function(){this.shippingAddress$=this.store.pipe(r.select(g)),this.selectedShippingOptionId$=this.store.pipe(r.select(h)),this.isShippingAddressValid$=this.store.pipe(r.select(y))},e.prototype.updateShippingAddress=function(e){this.store.dispatch(new d(e))},e.prototype.selectShippingOption=function(e){this.store.dispatch(new l(e))},e.decorators=[{type:t.Component,args:[{selector:"[shipping-container]",template:"<ng-content></ng-content>",exportAs:"ShippingContainer"}]}],e.ctorParameters=function(){return[{type:r.Store}]},e}();var S=r.createFeatureSelector("order"),m=r.createSelector(S,function(e){return e.order}),I=r.createSelector(m,function(e){return e.order}),O=r.createSelector(m,function(e){return e.loading}),P=r.createSelector(m,function(e){return e.errors}),v=function(){function e(e){this.store=e}return e.prototype.ngOnInit=function(){this.order$=this.store.pipe(r.select(I)),this.loading$=this.store.pipe(r.select(O))},e.decorators=[{type:t.Component,args:[{selector:"[order-container]",template:"<ng-content></ng-content>",exportAs:"OrderContainer"}]}],e.ctorParameters=function(){return[{type:r.Store}]},e}();var b={UpdatePaymentInfoAction:"[Payment] Update Payment Info Action"},D=function(e){this.payload=e,this.type=b.UpdatePaymentInfoAction};var j={paymentInfo:null};function B(e,t){switch(void 0===e&&(e=j),t.type){case b.UpdatePaymentInfoAction:return c({},e,{paymentInfo:t.payload});default:return e}}var F={payment:B},M=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[r.StoreModule.forFeature("payment",F)]}]}],e}(),w=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,M]}]}],e}(),$=r.createFeatureSelector("payment"),x=r.createSelector($,function(e){return e.payment}),U=r.createSelector(x,function(e){return e.paymentInfo}),C=function(){function e(e){this.store=e,this.paymentInfo$=this.store.pipe(r.select(U))}return e.prototype.dispatch=function(e){this.store.dispatch(e)},e.decorators=[{type:t.Injectable,args:[{providedIn:w}]}],e.ctorParameters=function(){return[{type:r.Store}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(r.Store))},token:e,providedIn:w}),e}();var T=new t.InjectionToken("DaffPaymentDriver"),k=new t.InjectionToken("DaffOrderDriver");var R=new t.InjectionToken("DaffPaymentTransformer"),N={UpdateBillingAddressAction:"[Billing] Update Billing Address Action",UpdatePaymentInfoAction:"[Billing] Update Payment Info Action",ToggleBillingAddressIsShippingAddressAction:"[Billing] Billing Address Is Shipping Address Action"},q=function(e){this.payload=e,this.type=N.UpdateBillingAddressAction};var E=function(e){this.payload=e,this.type=N.UpdatePaymentInfoAction};var V=function(){this.type=N.ToggleBillingAddressIsShippingAddressAction};var _=r.createFeatureSelector("billing"),L=r.createSelector(_,function(e){return e.billing}),z=r.createSelector(L,function(e){return e.billingAddress}),G=r.createSelector(L,function(e){return e.billingAddressIsShippingAddress}),H=r.createSelector(L,function(e){return e.paymentInfo}),J={billingAddress:null,billingAddressIsShippingAddress:!1,paymentInfo:null};function K(e,t){switch(void 0===e&&(e=J),t.type){case N.UpdateBillingAddressAction:return c({},e,{billingAddress:t.payload});case N.ToggleBillingAddressIsShippingAddressAction:return c({},e,{billingAddress:null,billingAddressIsShippingAddress:!e.billingAddressIsShippingAddress});case N.UpdatePaymentInfoAction:return c({},e,{paymentInfo:t.payload});default:return e}}var Q={billing:K},W=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[r.StoreModule.forFeature("billing",Q)]}]}],e}(),X=function(){function e(e){this.store=e}return e.prototype.ngOnInit=function(){this.billingAddress$=this.store.pipe(r.select(z)),this.billingAddressIsShippingAddress$=this.store.pipe(r.select(G)),this.paymentInfo$=this.store.pipe(r.select(H))},e.prototype.updateBillingAddress=function(e){this.store.dispatch(new q(e))},e.prototype.toggleBillingAddressIsShippingAddress=function(){this.store.dispatch(new V)},e.prototype.updatePaymentInfo=function(e){this.store.dispatch(new E(e))},e.decorators=[{type:t.Component,args:[{selector:"[billing-container]",template:"<ng-content></ng-content>",exportAs:"BillingContainer"}]}],e.ctorParameters=function(){return[{type:r.Store}]},e}();var Y=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,W],declarations:[X],exports:[X]}]}],e}(),Z=function(){function e(e){this.store=e,this.billingAddress$=this.store.pipe(r.select(z)),this.billingAddressIsShippingAddress$=this.store.pipe(r.select(G)),this.paymentInfo$=this.store.pipe(r.select(H))}return e.prototype.dispatch=function(e){this.store.dispatch(e)},e.decorators=[{type:t.Injectable,args:[{providedIn:Y}]}],e.ctorParameters=function(){return[{type:r.Store}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(r.Store))},token:e,providedIn:Y}),e}();var ee={shippingAddress:null,selectedShippingOptionId:null};function te(e,t){switch(void 0===e&&(e=ee),t.type){case p.UpdateShippingAddressAction:return c({},e,{shippingAddress:t.payload});case p.SelectShippingOptionAction:return c({},e,{selectedShippingOptionId:t.payload});default:return e}}var re={shipping:te},ne=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[r.StoreModule.forFeature("shipping",re)]}]}],e}(),ie=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,ne],declarations:[A],exports:[A]}]}],e}(),oe=function(){function e(e){this.store=e,this.shippingAddress$=this.store.pipe(r.select(g)),this.selectedShippingOptionId$=this.store.pipe(r.select(h)),this.isShippingAddressValid$=this.store.pipe(r.select(y))}return e.prototype.dispatch=function(e){this.store.dispatch(e)},e.decorators=[{type:t.Injectable,args:[{providedIn:ie}]}],e.ctorParameters=function(){return[{type:r.Store}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(r.Store))},token:e,providedIn:ie}),e}();var se={PlaceOrderAction:"[Order] Place Order Action",PlaceOrderSuccessAction:"[Order] Place Order Success Action",PlaceOrderFailureAction:"[Order] Place Order Failure Action"},ce=function(e){this.payload=e,this.type=se.PlaceOrderAction};var ae=function(e){this.payload=e,this.type=se.PlaceOrderAction};var pe=function(e){this.payload=e,this.type=se.PlaceOrderSuccessAction};var de=function(e){this.payload=e,this.type=se.PlaceOrderFailureAction};var le={order:null,loading:!1,errors:[]};function fe(e,t){switch(void 0===e&&(e=le),t.type){case se.PlaceOrderAction:return c({},e,{loading:!0});case se.PlaceOrderSuccessAction:return c({},e,{order:t.payload,loading:!1});case se.PlaceOrderFailureAction:return c({},e,{errors:[t.payload],loading:!1});default:return e}}var ue={order:fe},ge=new t.InjectionToken("DaffCheckoutDriver"),he=function(){function e(e,t){var r=this;this.actions$=e,this.checkoutDriver=t,this.onPlaceOrder$=this.actions$.pipe(i.ofType(se.PlaceOrderAction),o.switchMap(function(e){return r.checkoutDriver.placeOrder(e.payload.id.toString()).pipe(o.map(function(e){return new pe(e)}),o.catchError(function(e){return s.of(new de("Failed to place order"))}))}))}return e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:i.Actions},{type:void 0,decorators:[{type:t.Inject,args:[ge]}]}]},function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);o>3&&s&&Object.defineProperty(t,r,s)}([i.Effect(),a("design:type",s.Observable)],e.prototype,"onPlaceOrder$",void 0),e}();var ye=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[r.StoreModule.forFeature("order",ue),i.EffectsModule.forFeature([he])]}]}],e}(),Ae=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,ye],declarations:[v],exports:[v]}]}],e}(),Se=function(){function e(e){this.store=e,this.order$=this.store.pipe(r.select(I)),this.loading$=this.store.pipe(r.select(O)),this.errors$=this.store.pipe(r.select(P))}return e.prototype.dispatch=function(e){this.store.dispatch(e)},e.decorators=[{type:t.Injectable,args:[{providedIn:Ae}]}],e.ctorParameters=function(){return[{type:r.Store}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(r.Store))},token:e,providedIn:Ae}),e}();var me=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,ie,w,Y,Ae],exports:[ie,w,Y,Ae]}]}],e}();e.DaffBillingActionTypes=N,e.DaffBillingFacade=Z,e.DaffBillingModule=Y,e.DaffCheckoutDriver=ge,e.DaffOrderActionTypes=se,e.DaffOrderDriver=k,e.DaffOrderFacade=Se,e.DaffOrderModule=Ae,e.DaffPaymentActionTypes=b,e.DaffPaymentDriver=T,e.DaffPaymentFacade=C,e.DaffPaymentTransformer=R,e.DaffPlaceOrder=ae,e.DaffPlaceOrderFailure=de,e.DaffPlaceOrderSuccess=pe,e.DaffSelectShippingOption=l,e.DaffShippingActionTypes=p,e.DaffShippingFacade=oe,e.DaffShippingModule=ie,e.DaffToggleBillingAddressIsShippingAddress=V,e.DaffUpdateBillingAddress=q,e.DaffUpdatePaymentInfo=D,e.DaffUpdateShippingAddress=d,e.OrderActionTypes={PlaceOrderAction:"[Order] Place Order Action",PlaceOrderSuccessAction:"[Order] Place Order Success Action",PlaceOrderFailureAction:"[Order] Place Order Failure Action"},e.OrderContainer=v,e.PlaceOrder=ce,e.ShippingContainer=A,e.StateCheckoutModule=me,e.daffBillingReducer=K,e.daffBillingReducers=Q,e.daffOrderReducer=fe,e.daffOrderReducers=ue,e.daffPaymentReducers=F,e.daffShippingReducer=te,e.daffShippingReducers=re,e.selectBillingAddress=z,e.selectBillingAddressIsShippingAddress=G,e.selectBillingFeatureState=_,e.selectBillingState=L,e.selectErrors=P,e.selectIsShippingAddressValid=y,e.selectLoading=O,e.selectOrder=I,e.selectOrderFeatureState=S,e.selectOrderState=m,e.selectPaymentFeatureState=$,e.selectPaymentInfo=U,e.selectPaymentState=x,e.selectShippingAddress=g,e.selectShippingFeatureState=f,e.selectShippingOptionId=h,e.selectShippingState=u,e.ɵa=w,e.ɵb=M,e.ɵc=B,e.ɵe=W,e.ɵf=X,e.ɵg=ne,e.ɵh=ye,e.ɵi=he,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=daffodil-checkout.umd.min.js.map
{"version":3,"file":"daffodil-driver-hubspot.js","sources":["ng://@daffodil/driver/hubspot/transformers/json-builder.ts","ng://@daffodil/driver/hubspot/hubspot-forms.service.ts","ng://@daffodil/driver/hubspot/hubspot-forms.provider.ts","ng://@daffodil/driver/hubspot/daffodil-driver-hubspot.ts"],"sourcesContent":["import { FieldValue } from '../models/hubspot-request'\n\n\nexport const jsonBuilder = (payload: object): FieldValue[] => {\n  return Object.keys(payload).map((key) => ({'name': key, 'value': payload[key]}));\n}","import { HttpClient } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { Title } from '@angular/platform-browser';\n\nimport { Observable } from 'rxjs';\n\nimport { jsonBuilder } from './transformers/json-builder';\nimport { DaffHubspotConfig } from './models/config';\nimport { DaffHubspotRequest } from './models/hubspot-request';\nimport { HubspotResponse } from './models/hubspot-response';\n\nexport class DaffHubspotFormsService {\n\n  constructor(\n    private http: HttpClient,\n    private document: Document,\n    private route: Router,\n    private title: Title,\n    private config: DaffHubspotConfig) { }\n    \n\n  submit(payload: Object): Observable<HubspotResponse> {\n    return this.http.post<HubspotResponse>(\n      this.generateUrl(this.config.portalId, this.config.guid, this.config.version), \n      this.makeRequest(payload)\n    );\n  }\n\n  private makeRequest(payload): DaffHubspotRequest {\n    return {\n      'fields': [\n        ...jsonBuilder(payload)\n      ], \n      'context': {\n        'hutk': this.getCookie(),\n        'pageUri': this.getPageURI(),\n        'pageName': this.title.getTitle()\n      }\n    }\n  }\n\n  private generateUrl(portalId: string, guid: string, version: string): string {\n    if (version === undefined) {\n      version = 'v3'\n    }\n    return 'https://api.hsforms.com/submissions/' + version + '/integration/submit/'\n      + portalId + '/' + guid;\n  }\n  private getCookie() {\n    if (!this.document) {\n      return null;\n    }\n    const name = 'hubspotutk';\n    const v = this.document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)');\n    return v ? v[2] : null;\n  }\n  private getPageURI() {\n    if (!this.route) {\n      return null;\n    }\n    return this.route.url;\n  }\n}","import { HttpClient } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { Title } from '@angular/platform-browser';\nimport { DaffHubspotConfig } from './models/config';\nimport { DaffHubspotFormsService } from './hubspot-forms.service';\n\n\nexport const daffHubspotFormsServiceFactory = (\n  http: HttpClient, \n  document: Document, \n  router: Router, \n  title: Title, \n  config: DaffHubspotConfig\n) => {\n  return new DaffHubspotFormsService(http, document, router, title, config);\n};","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;AAGO,IAAM,WAAW,GAAG,UAAC,OAAe;IACzC,OAAO,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,UAAC,GAAG,IAAK,QAAC,EAAC,MAAM,EAAE,GAAG,EAAE,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,EAAC,IAAC,CAAC,CAAC;CAClF,CAAA;;;ICQC,iCACU,IAAgB,EAChB,QAAkB,EAClB,KAAa,EACb,KAAY,EACZ,MAAyB;QAJzB,SAAI,GAAJ,IAAI,CAAY;QAChB,aAAQ,GAAR,QAAQ,CAAU;QAClB,UAAK,GAAL,KAAK,CAAQ;QACb,UAAK,GAAL,KAAK,CAAO;QACZ,WAAM,GAAN,MAAM,CAAmB;KAAK;IAGxC,wCAAM,GAAN,UAAO,OAAe;QACpB,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CACnB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,EAC7E,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAC1B,CAAC;KACH;IAEO,6CAAW,GAAnB,UAAoB,OAAO;QACzB,OAAO;YACL,QAAQ,WACH,WAAW,CAAC,OAAO,CAAC,CACxB;YACD,SAAS,EAAE;gBACT,MAAM,EAAE,IAAI,CAAC,SAAS,EAAE;gBACxB,SAAS,EAAE,IAAI,CAAC,UAAU,EAAE;gBAC5B,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;aAClC;SACF,CAAA;KACF;IAEO,6CAAW,GAAnB,UAAoB,QAAgB,EAAE,IAAY,EAAE,OAAe;QACjE,IAAI,OAAO,KAAK,SAAS,EAAE;YACzB,OAAO,GAAG,IAAI,CAAA;SACf;QACD,OAAO,sCAAsC,GAAG,OAAO,GAAG,sBAAsB;cAC5E,QAAQ,GAAG,GAAG,GAAG,IAAI,CAAC;KAC3B;IACO,2CAAS,GAAjB;QACE,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAClB,OAAO,IAAI,CAAC;SACb;QACD,IAAM,IAAI,GAAG,YAAY,CAAC;QAC1B,IAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,GAAG,IAAI,GAAG,eAAe,CAAC,CAAC;QACzE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;KACxB;IACO,4CAAU,GAAlB;QACE,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YACf,OAAO,IAAI,CAAC;SACb;QACD,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;KACvB;IACH,8BAAC;CAAA;;ICvDY,8BAA8B,GAAG,UAC5C,IAAgB,EAChB,QAAkB,EAClB,MAAc,EACd,KAAY,EACZ,MAAyB;IAEzB,OAAO,IAAI,uBAAuB,CAAC,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;CAC3E;;ACfD;;GAEG;;;;"}
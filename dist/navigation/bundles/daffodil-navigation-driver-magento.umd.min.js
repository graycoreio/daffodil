!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/common"),require("@daffodil/navigation/driver"),require("rxjs/operators"),require("apollo-angular"),require("graphql-tag")):"function"==typeof define&&define.amd?define("@daffodil/navigation/driver/magento",["exports","@angular/core","@angular/common","@daffodil/navigation/driver","rxjs/operators","apollo-angular","graphql-tag"],r):r(((e=e||self).daffodil=e.daffodil||{},e.daffodil.navigation=e.daffodil.navigation||{},e.daffodil.navigation.driver=e.daffodil.navigation.driver||{},e.daffodil.navigation.driver.magento={}),e.ng.core,e.ng.common,e.daffodil.navigation.driver,e.rxjs.operators,e.apolloAngular,e.gql)}(this,function(e,r,n,t,o,a,i){"use strict";i=i&&i.hasOwnProperty("default")?i.default:i;function u(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e}var c=new r.InjectionToken("MAGENTO_NAVIGATION_TREE_QUERY_DEPTH",{factory:function(){return 3}});var f,d,l="\n\tid\n\tlevel\n\tname\n\tinclude_in_menu\n\tbreadcrumbs {\n\t\tcategory_id\n\t\tcategory_name\n\t\tcategory_level\n\t\tcategory_url_key\n\t}\n\tproduct_count\n";function g(e){return void 0===e&&(e=3),i(d||(d=u(["\n    query GetCategoryTree($filters: CategoryFilterInput!){\n      categoryList(filters: $filters) {\n        ...recursiveCategoryNode\n      }\n    }\n    ","\n  "],["\n    query GetCategoryTree($filters: CategoryFilterInput!){\n      categoryList(filters: $filters) {\n        ...recursiveCategoryNode\n      }\n    }\n    ","\n  "])),function(e){void 0===e&&(e=3);var r=new Array(e).fill(null).reduce(function(e){return"\n    "+l+"\n    children_count\n    children {\n      "+e+"\n    }\n  "},l);return i(f||(f=u(["\n    fragment recursiveCategoryNode on CategoryTree {\n      ","\n    }\n  "],["\n    fragment recursiveCategoryNode on CategoryTree {\n      ","\n    }\n  "])),r)}(e))}var s=function(){function e(e,r,n){this.apollo=e,this.transformer=r,this.categoryTreeQueryDepth=n}return e.prototype.get=function(e){var r=this;return this.apollo.query({query:g(this.categoryTreeQueryDepth),variables:{filters:{ids:{eq:e}}}}).pipe(o.map(function(e){return r.transformer.transform(e.data.categoryList[0])}))},e.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:a.Apollo},{type:void 0,decorators:[{type:r.Inject,args:[t.DaffNavigationTransformer]}]},{type:Number,decorators:[{type:r.Inject,args:[c]}]}]},e.ngInjectableDef=r.ɵɵdefineInjectable({factory:function(){return new e(r.ɵɵinject(a.Apollo),r.ɵɵinject(t.DaffNavigationTransformer),r.ɵɵinject(c))},token:e,providedIn:"root"}),e}();var y=function(){function e(){}return e.prototype.transform=function(e){var r=this;return{id:e.id,path:e.id,name:e.name,total_products:e.product_count,children_count:e.children_count,breadcrumbs:e.breadcrumbs?e.breadcrumbs.map(function(e){return r.transformBreadcrumb(e)}).sort(function(e,r){return e.categoryLevel-r.categoryLevel}):[],children:e.children&&e.children.filter(function(e){return e.include_in_menu}).map(function(e){return r.transform(e)})}},e.prototype.transformBreadcrumb=function(e){return{categoryId:e.category_id,categoryName:e.category_name,categoryLevel:e.category_level,categoryUrlKey:e.category_url_key}},e.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=r.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),v={navigationTreeQueryDepth:3},p=function(){function e(){}return e.forRoot=function(r){return void 0===r&&(r=v),{ngModule:e,providers:[{provide:t.DaffNavigationDriver,useExisting:s},{provide:t.DaffNavigationTransformer,useExisting:y},{provide:c,useValue:r.navigationTreeQueryDepth}]}},e.decorators=[{type:r.NgModule,args:[{imports:[n.CommonModule]}]}],e}();e.DaffMagentoNavigationService=s,e.DaffMagentoNavigationTransformerService=y,e.DaffNavigationMagentoDriverModule=p,e.MAGENTO_NAVIGATION_DEFAULT_CONFIGURATION=v,e.MAGENTO_NAVIGATION_TREE_QUERY_DEPTH=c,e.daffMagentoGetCategoryTree=g,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=daffodil-navigation-driver-magento.umd.min.js.map
!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("graphql-tag"),require("apollo-angular"),require("rxjs"),require("rxjs/operators"),require("@daffodil/geography/driver"),require("@daffodil/driver/magento"),require("@angular/common")):"function"==typeof define&&define.amd?define("@daffodil/geography/driver/magento",["exports","@angular/core","graphql-tag","apollo-angular","rxjs","rxjs/operators","@daffodil/geography/driver","@daffodil/driver/magento","@angular/common"],n):n(((r=r||self).daffodil=r.daffodil||{},r.daffodil.geography=r.daffodil.geography||{},r.daffodil.geography.driver=r.daffodil.geography.driver||{},r.daffodil.geography.driver.magento={}),r.ng.core,r.gql,r.apolloAngular,r.rxjs,r.rxjs.operators,r.daffodil.geography.driver,r.magento,r.ng.common)}(this,function(r,n,e,t,o,a,i,u,f){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var c=this&&this.__assign||function(){return(c=Object.assign||function(r){for(var n,e=1,t=arguments.length;e<t;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o]);return r}).apply(this,arguments)},l=function(){function r(){}return r.prototype.transform=function(r){return r?c({magento_region:r},{id:String(r.id),name:r.name,iso_3166_2:r.code}):null},r.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],r.ngInjectableDef=n.ɵɵdefineInjectable({factory:function(){return new r},token:r,providedIn:"root"}),r}(),s=this&&this.__assign||function(){return(s=Object.assign||function(r){for(var n,e=1,t=arguments.length;e<t;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o]);return r}).apply(this,arguments)},d=function(){function r(r){this.subdivisionTransformer=r}return r.prototype.transformSubdivisions=function(r){var n=this;return r.map(function(r){return n.subdivisionTransformer.transform(r)})},r.prototype.transform=function(r){return r?s({magento_country:r},{subdivisions:this.transformSubdivisions(r.available_regions||[]),id:r.id,name:r.full_name_locale,name_en:r.full_name_english,alpha2:r.two_letter_abbreviation,alpha3:r.three_letter_abbreviation}):null},r.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],r.ctorParameters=function(){return[{type:l}]},r.ngInjectableDef=n.ɵɵdefineInjectable({factory:function(){return new r(n.ɵɵinject(l))},token:r,providedIn:"root"}),r}();var p,g,y,m,h,v=this&&this.__makeTemplateObject||function(r,n){return Object.defineProperty?Object.defineProperty(r,"raw",{value:n}):r.raw=n,r},b=e(p||(p=v(["\n  fragment country on Country {\n    id\n    full_name_english\n    full_name_locale\n    three_letter_abbreviation\n    two_letter_abbreviation\n  }\n"],["\n  fragment country on Country {\n    id\n    full_name_english\n    full_name_locale\n    three_letter_abbreviation\n    two_letter_abbreviation\n  }\n"]))),_=this&&this.__makeTemplateObject||function(r,n){return Object.defineProperty?Object.defineProperty(r,"raw",{value:n}):r.raw=n,r},j=e(g||(g=_(["\n  fragment region on Region {\n    code\n    id\n    name\n  }\n"],["\n  fragment region on Region {\n    code\n    id\n    name\n  }\n"]))),I=this&&this.__makeTemplateObject||function(r,n){return Object.defineProperty?Object.defineProperty(r,"raw",{value:n}):r.raw=n,r},w=e(y||(y=I(["\n  query GetCountries {\n    countries {\n      ...country\n    }\n  }\n  ","\n"],["\n  query GetCountries {\n    countries {\n      ...country\n    }\n  }\n  ","\n"])),b),q=this&&this.__makeTemplateObject||function(r,n){return Object.defineProperty?Object.defineProperty(r,"raw",{value:n}):r.raw=n,r},O=e(m||(m=q(["\n  query GetCountry($countryId: String!) {\n    country(id: $countryId) {\n      ...country\n      available_regions {\n        ...region\n      }\n    }\n  }\n  ","\n  ","\n"],["\n  query GetCountry($countryId: String!) {\n    country(id: $countryId) {\n      ...country\n      available_regions {\n        ...region\n      }\n    }\n  }\n  ","\n  ","\n"])),b,j),P=function(r){if(r.data.countries)return r;throw new i.DaffGeographyInvalidAPIResponseError("Get countries response does not contain a valid list of countries.")},D=((h={})["graphql-no-such-entity"]=i.DaffCountryNotFoundError,h);function T(r){return u.daffTransformMagentoError(r,D)}var C=function(){function r(r,n){this.apollo=r,this.countryTransformer=n}return r.prototype.list=function(){var r=this;return this.apollo.query({query:w}).pipe(a.map(P),a.map(function(n){return n.data.countries.map(function(n){return r.countryTransformer.transform(n)})}),a.catchError(function(r){return o.throwError(T(r))}))},r.prototype.get=function(r){var n=this;return this.apollo.query({query:O,variables:{countryId:r}}).pipe(a.map(function(r){return n.countryTransformer.transform(r.data.country)}),a.catchError(function(r){return o.throwError(T(r))}))},r.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],r.ctorParameters=function(){return[{type:t.Apollo},{type:d}]},r.ngInjectableDef=n.ɵɵdefineInjectable({factory:function(){return new r(n.ɵɵinject(t.Apollo),n.ɵɵinject(d))},token:r,providedIn:"root"}),r}();var x=function(){function r(){}return r.forRoot=function(){return{ngModule:r,providers:[{provide:i.DaffGeographyDriver,useExisting:C}]}},r.decorators=[{type:n.NgModule,args:[{imports:[f.CommonModule]}]}],r}();r.DaffGeographyMagentoDriverModule=x,r.DaffGeographyMagentoService=C,r.DaffMagentoCountryTransformer=d,r.DaffMagentoSubdivisionTransformer=l,r.countryFragment=b,r.getCountries=w,r.getCountry=O,r.regionFragment=j,Object.defineProperty(r,"__esModule",{value:!0})});
//# sourceMappingURL=daffodil-geography-driver-magento.umd.min.js.map
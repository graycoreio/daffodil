{"version":3,"file":"daffodil-geography-driver-in-memory.umd.js","sources":["ng://@daffodil/geography/driver/in-memory/drivers/geography.service.ts","ng://@daffodil/geography/driver/in-memory/drivers/geography-driver.module.ts","ng://@daffodil/geography/driver/in-memory/backend/geography.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\n\nimport {\n  DaffCountry,\n} from '@daffodil/geography';\nimport {\n  DaffGeographyServiceInterface,\n  DaffCountryNotFoundError\n} from '@daffodil/geography/driver';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DaffInMemoryGeographyService implements DaffGeographyServiceInterface<DaffCountry> {\n  url = '/api/countries';\n\n  constructor(private http: HttpClient) {}\n\n  get(countryId: DaffCountry['id']): Observable<DaffCountry> {\n    return this.http.get<DaffCountry>(`${this.url}/${countryId}`).pipe(\n\t\t\tcatchError((error: Error) => throwError(DaffCountryNotFoundError)),\n\t\t\tmap(result => result)\n\t\t);\n  }\n\n  list(): Observable<DaffCountry[]> {\n    return this.http.get<DaffCountry[]>(`${this.url}/`);\n  }\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport {\n  DaffGeographyDriver,\n} from '@daffodil/geography/driver';\n\nimport { DaffInMemoryGeographyService } from './geography.service';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ]\n})\nexport class DaffGeographyInMemoryDriverModule {\n  static forRoot(): ModuleWithProviders {\n    return {\n      ngModule: DaffGeographyInMemoryDriverModule,\n      providers: [\n        {\n          provide: DaffGeographyDriver,\n          useExisting: DaffInMemoryGeographyService\n        },\n      ]\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  InMemoryDbService,\n  RequestInfo,\n  STATUS\n} from 'angular-in-memory-web-api';\n\nimport { DaffInMemoryDataServiceInterface } from '@daffodil/core/testing';\nimport { DaffCountry } from '@daffodil/geography';\nimport {\n  DaffCountryFactory,\n  DaffSubdivisionFactory\n} from '@daffodil/geography/testing';\n\n/**\n * An in-memory service that stubs out the backend services for getting countries.\n */\n@Injectable({\n  providedIn: 'root'\n})\nexport class DaffInMemoryBackendGeographyService implements InMemoryDbService, DaffInMemoryDataServiceInterface {\n  countries: DaffCountry[];\n\n  constructor(\n    private countryFactory: DaffCountryFactory,\n    private subdivisionFactory: DaffSubdivisionFactory\n  ) {\n    this.countries = this.countryFactory.createMany(5);\n    this.countries.forEach(country => country.subdivisions = this.subdivisionFactory.createMany(5))\n  }\n\n  /**\n   * Creates a fake database of countries for the geography inmemory backend service.\n   *\n   * @returns A fake database of an array of countries\n   */\n  createDb(reqInfo: RequestInfo): any {\n    if (reqInfo) {\n      const seedData = reqInfo.utils.getJsonBody(reqInfo.req).countries;\n      if (seedData) {\n        this.countries = seedData;\n      }\n    }\n\n    return {\n      countries: this.countries\n    };\n  }\n\n  /**\n   * Responds to GET requests.\n   */\n  get(reqInfo: RequestInfo): any {\n    return reqInfo.utils.createResponse$(() => ({\n      body: reqInfo.id ? this.getCountry(reqInfo) : this.listCountries(reqInfo),\n      status: STATUS.OK\n    }))\n  }\n\n  private getCountry(reqInfo: RequestInfo) {\n    return reqInfo.collection.find(country => country.id === reqInfo.id)\n  }\n\n  private listCountries(reqInfo: RequestInfo) {\n    return reqInfo.collection\n  }\n}\n"],"names":["catchError","throwError","DaffCountryNotFoundError","map","Injectable","HttpClient","DaffGeographyDriver","NgModule","CommonModule","STATUS","DaffCountryFactory","DaffSubdivisionFactory"],"mappings":"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"}
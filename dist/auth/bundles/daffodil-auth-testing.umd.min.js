!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("faker/locale/en_US"),require("@daffodil/core/testing"),require("angular-in-memory-web-api"),require("@angular/common"),require("@daffodil/auth"),require("rxjs"),require("@angular/common/http"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@daffodil/auth/testing",["exports","@angular/core","faker/locale/en_US","@daffodil/core/testing","angular-in-memory-web-api","@angular/common","@daffodil/auth","rxjs","@angular/common/http","rxjs/operators"],e):e(((t=t||self).daffodil=t.daffodil||{},t.daffodil.auth=t.daffodil.auth||{},t.daffodil.auth.testing={}),t.ng.core,t.en_US,t.testing,t.angularInMemoryWebApi,t.ng.common,t.daffodil.auth,t.rxjs,t.ng.common.http,t.rxjs.operators)}(this,function(t,e,r,o,n,i,a,u,c,f){"use strict";var s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function p(t,e){function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var d=function(){this.email=r.internet.email(),this.firstName=r.name.firstName(),this.lastName=r.name.lastName()};var l=function(t){function r(){return t.call(this,d)||this}return p(r,t),r.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],r.ctorParameters=function(){return[]},r.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new r},token:r,providedIn:"root"}),r}(o.DaffModelFactory),g=function(){function t(){this.customer=this.fakeCustomer(),this.password=r.random.alphaNumeric(16)}return t.prototype.fakeCustomer=function(){return(new l).create()},t}();var h=function(t){function r(){return t.call(this,g)||this}return p(r,t),r.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],r.ctorParameters=function(){return[]},r.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new r},token:r,providedIn:"root"}),r}(o.DaffModelFactory),y=function(){this.token=r.random.alphaNumeric(16)};var m=function(t){function r(){return t.call(this,y)||this}return p(r,t),r.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],r.ctorParameters=function(){return[]},r.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new r},token:r,providedIn:"root"}),r}(o.DaffModelFactory),v=function(){function t(){}return t.prototype.generateToken=function(){return r.random.alphaNumeric(16)},t.prototype.generateId=function(){return r.random.uuid()},t.prototype.createDb=function(){return{auth:{}}},t.prototype.post=function(t){return"login"===t.id?this.login(t):"register"===t.id?this.register(t):"logout"===t.id?this.logout(t):"check"===t.id?this.check(t):void 0},t.prototype.login=function(t){var e=this;return t.utils.createResponse$(function(){return{body:{token:e.generateToken()},status:n.STATUS.OK}})},t.prototype.register=function(t){var e=t.utils.getJsonBody(t.req),r=e.customer,o=e.password;return t.utils.createResponse$(function(){return{body:{email:r.email,password:o},status:n.STATUS.CREATED}})},t.prototype.logout=function(t){return t.utils.createResponse$(function(){return{body:{success:!0},status:n.STATUS.OK}})},t.prototype.check=function(t){return t.utils.createResponse$(function(){return{body:{},status:n.STATUS.OK}})},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),I=function(){function t(t){this.factory=t}return t.prototype.login=function(t){return u.of(this.factory.create())},t.prototype.logout=function(){return u.of(void 0)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:m}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(m))},token:t,providedIn:"root"}),t}();var j=function(){function t(){}return t.prototype.register=function(t){return u.of({email:t.customer.email,password:t.password})},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),b=function(){function t(){}return t.prototype.check=function(){return u.of(void 0)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),D=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[{provide:a.DaffLoginDriver,useExisting:I},{provide:a.DaffRegisterDriver,useExisting:j},{provide:a.DaffAuthDriver,useExisting:b}]}},t.decorators=[{type:e.NgModule,args:[{imports:[i.CommonModule]}]}],t}(),k=function(){function t(t){this.http=t,this.url="/api/auth/"}return t.prototype.login=function(t){return this.http.post(this.url+"login",t)},t.prototype.logout=function(){return this.http.post(this.url+"logout",{}).pipe(f.switchMap(function(t){return t.success?u.of(void 0):u.throwError(new Error("Logout failed"))}))},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:c.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(c.HttpClient))},token:t,providedIn:"root"}),t}();var w=function(){function t(t){this.http=t,this.url="/api/auth/"}return t.prototype.register=function(t){return this.http.post(this.url+"register",t).pipe(f.mapTo({email:t.customer.email,password:t.password}))},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:c.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(c.HttpClient))},token:t,providedIn:"root"}),t}();var M=function(){function t(t){this.http=t,this.url="/api/auth/"}return t.prototype.check=function(){return this.http.post(this.url+"check",{}).pipe(f.mapTo(void 0))},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:c.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(c.HttpClient))},token:t,providedIn:"root"}),t}();var x=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[{provide:a.DaffLoginDriver,useExisting:k},{provide:a.DaffRegisterDriver,useExisting:w},{provide:a.DaffAuthDriver,useExisting:M}]}},t.decorators=[{type:e.NgModule,args:[{imports:[i.CommonModule]}]}],t}();t.DaffAccountRegistrationFactory=h,t.DaffAuthInMemoryDriverModule=x,t.DaffAuthTestingDriverModule=D,t.DaffAuthTokenFactory=m,t.DaffCustomerRegistrationFactory=l,t.DaffInMemoryBackendAuthService=v,t.ɵa=I,t.ɵb=j,t.ɵc=b,t.ɵd=k,t.ɵe=w,t.ɵf=M,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=daffodil-auth-testing.umd.min.js.map
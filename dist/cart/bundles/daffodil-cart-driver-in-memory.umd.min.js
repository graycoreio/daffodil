!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs"),require("rxjs/operators"),require("@daffodil/cart/driver"),require("@angular/common"),require("angular-in-memory-web-api"),require("@daffodil/cart/testing")):"function"==typeof define&&define.amd?define("@daffodil/cart/driver/in-memory",["exports","@angular/core","@angular/common/http","rxjs","rxjs/operators","@daffodil/cart/driver","@angular/common","angular-in-memory-web-api","@daffodil/cart/testing"],e):e(((t=t||self).daffodil=t.daffodil||{},t.daffodil.cart=t.daffodil.cart||{},t.daffodil.cart.driver=t.daffodil.cart.driver||{},t.daffodil.cart.driver["in-memory"]={}),t.ng.core,t.ng.common.http,t.rxjs,t.rxjs.operators,t.daffodil.cart.driver,t.ng.common,t.angularInMemoryWebApi,t.daffodil.cart.testing)}(this,function(t,e,r,n,o,i,a,u,c){"use strict";var s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var p=function(){function t(t){this.http=t,this.url="/api/cart"}return t.prototype.get=function(t){return this.http.get(this.url+"/"+t).pipe(o.catchError(function(t){return n.throwError(i.DaffCartNotFoundError)}),o.map(function(t){return t}))},t.prototype.addToCart=function(t,e){return this.http.post(this.url+"/addToCart",{productId:t,qty:e})},t.prototype.clear=function(t){return this.http.post(this.url+"/"+t+"/clear",{})},t.prototype.create=function(){return this.http.post(this.url,{})},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var d=function(){function t(t){this.http=t,this.url="/api/cart-items"}return t.prototype.list=function(t){return this.http.get(this.url+"/"+t+"/")},t.prototype.get=function(t,e){return this.http.get(this.url+"/"+t+"/"+e)},t.prototype.add=function(t,e){return this.http.post(this.url+"/"+t+"/",e)},t.prototype.update=function(t,e,r){return this.http.put(this.url+"/"+t+"/"+e,r)},t.prototype.delete=function(t,e){return this.http.delete(this.url+"/"+t+"/"+e)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var f=function(){function t(t){this.http=t,this.url="/api/cart-billing-address"}return t.prototype.get=function(t){return this.http.get(this.url+"/"+t)},t.prototype.update=function(t,e){return this.http.put(this.url+"/"+t,e)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var l=function(){function t(t){this.http=t,this.url="/api/cart-payment"}return t.prototype.get=function(t){return this.http.get(this.url+"/"+t)},t.prototype.update=function(t,e){return this.http.put(this.url+"/"+t,{payment:e})},t.prototype.updateWithBilling=function(t,e,r){return this.http.put(this.url+"/"+t,{payment:e,address:r})},t.prototype.remove=function(t){return this.http.delete(this.url+"/"+t)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var y=function(){function t(t){this.http=t,this.url="/api/cart-payment-methods"}return t.prototype.list=function(t){return this.http.get(this.url+"/"+t)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var h=function(){function t(t){this.http=t,this.url="/api/cart-shipping-address"}return t.prototype.get=function(t){return this.http.get(this.url+"/"+t)},t.prototype.update=function(t,e){return this.http.put(this.url+"/"+t,e)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var g=function(){function t(t){this.http=t,this.url="/api/cart-shipping-information"}return t.prototype.get=function(t){return this.http.get(this.url+"/"+t)},t.prototype.update=function(t,e){return this.http.put(this.url+"/"+t,e)},t.prototype.delete=function(t){return this.http.delete(this.url+"/"+t)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var m=function(){function t(t){this.http=t,this.url="/api/cart-shipping-methods"}return t.prototype.list=function(t){return this.http.get(this.url+"/"+t)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var v=function(){function t(t){this.http=t,this.url="/api/cart-order"}return t.prototype.placeOrder=function(t,e){return this.http.post(this.url+"/"+t+"/",{payment:e})},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var I=function(){function t(t){this.http=t,this.url="/api/cart-coupon"}return t.prototype.list=function(t){return this.http.get(this.url+"/"+t+"/")},t.prototype.apply=function(t,e){return this.http.post(this.url+"/"+t+"/",e)},t.prototype.remove=function(t,e){return this.http.delete(this.url+"/"+t+"/"+e.code)},t.prototype.removeAll=function(t){return this.http.delete(this.url+"/"+t+"/")},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var S=function(){function t(t){this.http=t,this.url="/api/cart-address"}return t.prototype.update=function(t,e){return this.http.put(this.url+"/"+t,e)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t}();var b=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[{provide:i.DaffCartDriver,useExisting:p},{provide:i.DaffCartAddressDriver,useExisting:S},{provide:i.DaffCartBillingAddressDriver,useExisting:f},{provide:i.DaffCartItemDriver,useExisting:d},{provide:i.DaffCartPaymentDriver,useExisting:l},{provide:i.DaffCartPaymentMethodsDriver,useExisting:y},{provide:i.DaffCartShippingAddressDriver,useExisting:h},{provide:i.DaffCartShippingInformationDriver,useExisting:g},{provide:i.DaffCartShippingMethodsDriver,useExisting:m},{provide:i.DaffCartOrderDriver,useExisting:v},{provide:i.DaffCartCouponDriver,useExisting:I}]}},t.decorators=[{type:e.NgModule,args:[{imports:[a.CommonModule]}]}],t}(),C=function(){function t(t){this.cartFactory=t}return t.prototype.get=function(t){var e=this.getCart(t);return t.utils.createResponse$(function(){return{body:e,status:e?u.STATUS.OK:u.STATUS.NOT_FOUND}})},t.prototype.post=function(t){var e=this;return t.utils.createResponse$(function(){var r=e.getAction(t);return{body:"addToCart"===t.id?{}:"clear"===r?e.clear(t):e.create(t),status:u.STATUS.OK}})},t.prototype.getAction=function(t){return t.url.replace("/"+t.resourceUrl+t.id+"/","")},t.prototype.clear=function(t){var e=this.getCart(t);return e.items=[],e},t.prototype.create=function(t){var e=this.cartFactory.create();return t.collection.push(e),{id:e.id}},t.prototype.getCart=function(t){return t.utils.findById(t.collection,t.id)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:c.DaffCartFactory}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(c.DaffCartFactory))},token:t,providedIn:"root"}),t}();var j=function(){function t(t){this.cartItemFactory=t}return t.prototype.get=function(t){var e=this;return t.utils.createResponse$(function(){var r=e.getAction(t);return{body:r?e.getItem(t,r):e.listItems(t),status:u.STATUS.OK}})},t.prototype.put=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.updateItem(t,e.getAction(t)),status:u.STATUS.OK}})},t.prototype.post=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.addItem(t),status:u.STATUS.OK}})},t.prototype.delete=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.deleteItem(t,e.getAction(t)),status:u.STATUS.OK}})},t.prototype.getAction=function(t){return t.url.replace("/"+t.resourceUrl+t.id+"/","")},t.prototype.getCart=function(t){return t.utils.findById(t.collection,Number(t.id))},t.prototype.transformItemInput=function(t){return s({},this.cartItemFactory.create(),t,{product_id:t.productId})},t.prototype.listItems=function(t){return this.getCart(t).items},t.prototype.getItem=function(t,e){return this.getCart(t).items.find(function(t){var r=t.item_id;return String(r)===String(e)})},t.prototype.updateItem=function(t,e){var r=this.getCart(t),n=t.utils.getJsonBody(t.req),o=r.items.findIndex(function(t){var r=t.item_id;return String(e)===String(r)});return r.items[o]=s({},r.items[o],n),r.items=Object.assign([],r.items),r},t.prototype.addItem=function(t){var e=this.getCart(t),r=t.utils.getJsonBody(t.req),n=e.items.findIndex(function(t){return t.product_id===r.productId});return n>-1?e.items[n].qty=e.items[n].qty+r.qty:e.items.push(this.transformItemInput(r)),e.items=Object.assign([],e.items),e},t.prototype.deleteItem=function(t,e){var r=this.getCart(t),n=r.items.findIndex(function(t){var r=t.item_id;return String(e)===String(r)});return r.items.splice(n,1),r.items=Object.assign([],r.items),r},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:c.DaffCartItemFactory}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(c.DaffCartItemFactory))},token:t,providedIn:"root"}),t}();var D=function(){function t(){}return t.prototype.post=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.placeOrder(t),status:u.STATUS.OK}})},t.prototype.placeOrder=function(t){return{id:"8235422034",cartId:"89fdsa8sadf",orderId:"8235422034"}},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),A=function(){function t(){}return t.prototype.get=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.listCoupons(t),status:u.STATUS.OK}})},t.prototype.post=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.applyCoupon(t),status:u.STATUS.OK}})},t.prototype.delete=function(t){var e=this;return t.utils.createResponse$(function(){var r=e.getAction(t);return{body:r?e.removeCoupon(t,r):e.removeAllCoupons(t),status:u.STATUS.OK}})},t.prototype.getAction=function(t){return t.url.replace("/"+t.resourceUrl+t.id+"/","")},t.prototype.getCart=function(t){return t.utils.findById(t.collection,Number(t.id))},t.prototype.listCoupons=function(t){return this.getCart(t).coupons},t.prototype.applyCoupon=function(t){var e=this.getCart(t),r=t.utils.getJsonBody(t.req);return e.coupons.push(r),e},t.prototype.removeCoupon=function(t,e){var r=this.getCart(t);return r.coupons=r.coupons.filter(function(t){return t.code!==e}),r},t.prototype.removeAllCoupons=function(t){var e=this.getCart(t);return e.coupons=[],e},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),T=function(){function t(){}return t.prototype.put=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.updateAddress(t),status:u.STATUS.OK}})},t.prototype.getCart=function(t){return t.utils.findById(t.collection,Number(t.id))},t.prototype.updateAddress=function(t){var e=this.getCart(t),r=t.utils.getJsonBody(t.req);return e.billing_address=r,e.shipping_address=r,e},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),M=function(){function t(){}return t.prototype.get=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.getShippingAddress(t),status:u.STATUS.OK}})},t.prototype.put=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.updateShippingAddress(t),status:u.STATUS.OK}})},t.prototype.getCart=function(t){return t.utils.findById(t.collection,Number(t.id))},t.prototype.getShippingAddress=function(t){return this.getCart(t).shipping_address},t.prototype.updateShippingAddress=function(t){var e=this.getCart(t),r=t.utils.getJsonBody(t.req);return e.shipping_address=r,e},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),O=function(){function t(){}return t.prototype.get=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.getBillingAddress(t),status:u.STATUS.OK}})},t.prototype.put=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.updateBillingAddress(t),status:u.STATUS.OK}})},t.prototype.getCart=function(t){return t.utils.findById(t.collection,Number(t.id))},t.prototype.getBillingAddress=function(t){return this.getCart(t).billing_address},t.prototype.updateBillingAddress=function(t){var e=this.getCart(t),r=t.utils.getJsonBody(t.req);return e.billing_address=r,e},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),B=function(){function t(){}return t.prototype.get=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.listPaymentMethods(t),status:u.STATUS.OK}})},t.prototype.getCart=function(t){return t.utils.findById(t.collection,Number(t.id))},t.prototype.listPaymentMethods=function(t){return this.getCart(t).available_payment_methods},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),k=function(){function t(){}return t.prototype.get=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.listShippingMethods(t),status:u.STATUS.OK}})},t.prototype.getCart=function(t){return t.utils.findById(t.collection,Number(t.id))},t.prototype.listShippingMethods=function(t){return this.getCart(t).available_shipping_methods},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),P=function(){function t(){}return t.prototype.get=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.getPayment(t),status:u.STATUS.OK}})},t.prototype.put=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.updatePayment(t),status:u.STATUS.OK}})},t.prototype.delete=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.removePayment(t),status:u.STATUS.OK}})},t.prototype.getCart=function(t){return t.utils.findById(t.collection,Number(t.id))},t.prototype.getPayment=function(t){return this.getCart(t).payment},t.prototype.updatePayment=function(t){var e=this.getCart(t),r=t.utils.getJsonBody(t.req),n=r.payment,o=r.address;return e.payment=n,o&&(e.billing_address=o),e},t.prototype.removePayment=function(t){var e=this.getCart(t);return e.payment=null,e},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),R=function(){function t(){}return t.prototype.get=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.getShippingInformation(t),status:u.STATUS.OK}})},t.prototype.put=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.updateShippingInformation(t),status:u.STATUS.OK}})},t.prototype.delete=function(t){var e=this;return t.utils.createResponse$(function(){return{body:e.removeShippingInformation(t),status:u.STATUS.OK}})},t.prototype.getCart=function(t){return t.utils.findById(t.collection,Number(t.id))},t.prototype.getShippingInformation=function(t){return this.getCart(t).shipping_information},t.prototype.updateShippingInformation=function(t){var e=this.getCart(t),r=t.utils.getJsonBody(t.req);return e.shipping_information=r,e},t.prototype.removeShippingInformation=function(t){var e=this.getCart(t);return e.shipping_information=null,e},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),U=function(){function t(t,e,r,n,o,i,a,u,c,s,p){this.cartService=t,this.cartItemsService=e,this.cartOrderService=r,this.cartCouponService=n,this.cartAddressService=o,this.cartShippingAddressService=i,this.cartBillingAddressService=a,this.cartPaymentMethodsService=u,this.cartShippingMethodsService=c,this.cartPaymentService=s,this.cartShippingInformationService=p,this.carts=[]}return t.prototype.createDb=function(t){if(t){var e=t.utils.getJsonBody(t.req).carts;e&&(this.carts=e)}return{cart:this.carts}},t.prototype.get=function(t){return this.delegateRequest(t)},t.prototype.post=function(t){return this.delegateRequest(t)},t.prototype.put=function(t){return this.delegateRequest(t)},t.prototype.delete=function(t){return this.delegateRequest(t)},t.prototype.delegateRequest=function(t){switch(t.collection=this.carts,t.collectionName){case"cart":return this.cartService[t.method](t);case"cart-items":return this.cartItemsService[t.method](t);case"cart-order":return this.cartOrderService[t.method](t);case"cart-coupon":return this.cartCouponService[t.method](t);case"cart-address":return this.cartAddressService[t.method](t);case"cart-shipping-address":return this.cartShippingAddressService[t.method](t);case"cart-billing-address":return this.cartBillingAddressService[t.method](t);case"cart-payment-methods":return this.cartPaymentMethodsService[t.method](t);case"cart-shipping-methods":return this.cartShippingMethodsService[t.method](t);case"cart-payment":return this.cartPaymentService[t.method](t);case"cart-shipping-information":return this.cartShippingInformationService[t.method](t);default:return t.utils.createResponse$(function(){return{body:{},status:u.STATUS.OK}})}},t.COLLECTION_NAMES=["cart","cart-items","cart-order","cart-coupon","cart-address","cart-shipping-address","cart-billing-address","cart-payment-methods","cart-shipping-methods","cart-payment","cart-shipping-information"],t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:C},{type:j},{type:D},{type:A},{type:T},{type:M},{type:O},{type:B},{type:k},{type:P},{type:R}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(C),e.ɵɵinject(j),e.ɵɵinject(D),e.ɵɵinject(A),e.ɵɵinject(T),e.ɵɵinject(M),e.ɵɵinject(O),e.ɵɵinject(B),e.ɵɵinject(k),e.ɵɵinject(P),e.ɵɵinject(R))},token:t,providedIn:"root"}),t}();t.DaffCartInMemoryDriverModule=b,t.DaffInMemoryBackendCartAddressService=T,t.DaffInMemoryBackendCartBillingAddressService=O,t.DaffInMemoryBackendCartCouponService=A,t.DaffInMemoryBackendCartItemsService=j,t.DaffInMemoryBackendCartOrderService=D,t.DaffInMemoryBackendCartPaymentMethodsService=B,t.DaffInMemoryBackendCartPaymentService=P,t.DaffInMemoryBackendCartRootService=U,t.DaffInMemoryBackendCartService=C,t.DaffInMemoryBackendCartShippingAddressService=M,t.DaffInMemoryBackendCartShippingInformationService=R,t.DaffInMemoryBackendCartShippingMethodsService=k,t.DaffInMemoryCartBillingAddressService=f,t.DaffInMemoryCartCouponService=I,t.DaffInMemoryCartItemService=d,t.DaffInMemoryCartOrderService=v,t.DaffInMemoryCartPaymentMethodsService=y,t.DaffInMemoryCartPaymentService=l,t.DaffInMemoryCartService=p,t.DaffInMemoryCartShippingAddressService=h,t.DaffInMemoryCartShippingInformationService=g,t.DaffInMemoryCartShippingMethodsService=m,t.ɵa=S,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=daffodil-cart-driver-in-memory.umd.min.js.map
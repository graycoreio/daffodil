<div class="checkout" cart-container #CartContainer="CartContainer">
  <div class="checkout__shipping" shipping-container #ShippingContainer="ShippingContainer" *ngIf="!(CartContainer.loading$ | async)">
    <shipping 
      [isShippingInfoValid]="ShippingContainer.isShippingInfoValid$ | async"
      [shippingInfo]="ShippingContainer.shippingInfo$ | async"
      [selectedShippingOption]="ShippingContainer.selectedShippingOption$ | async"
      [showPaymentView]="showPaymentView$ | async"
      (updateShippingInfo)="ShippingContainer.updateShippingInfo($event)"
      (selectShippingOption)="ShippingContainer.selectShippingOption($event)"
      (continueToPayment)="onContinueToPayment()"></shipping>
  </div>
  <div class="checkout__payment" *ngIf="showPaymentView$ | async" billing-container #BillingContainer="BillingContainer">
    <payment
      [paymentInfo]="BillingContainer.paymentInfo$ | async" 
      [billingAddress]="BillingContainer.billingAddress$ | async"
      [billingAddressIsShippingAddress]="BillingContainer.billingAddressIsShippingAddress$ | async"
      (updatePaymentInfo)="BillingContainer.updatePaymentInfo($event)"
      (updateBillingAddress)="BillingContainer.updateBillingAddress($event)"
      (toggleBillingAddressIsShippingAddress)="BillingContainer.toggleBillingAddressIsShippingAddress()"></payment>
  </div>
  <div class="checkout__cart" *ngIf="!(CartContainer.loading$ | async)">
    <div class="checkout__desktop-cart">
      <checkout-cart-async-wrapper [cartTitle]="'CART SUMMARY'" [cart]="CartContainer.cart$ | async" [loading]="CartContainer.loading$ | async">
        <place-order></place-order>
      </checkout-cart-async-wrapper>
    </div>
    <accordion class="checkout__mobile-cart">
      <accordion-item [initiallyActive]="false">
        <h2 accordion-item-title>Cart Summary ({{(CartContainer.cart$ | async) ? (CartContainer.cart$ | async).items.length : 0}})</h2>
        <checkout-cart-async-wrapper [cart]="CartContainer.cart$ | async" [loading]="CartContainer.loading$ | async"></checkout-cart-async-wrapper>
      </accordion-item>
    </accordion>
  </div>
  <div class="checkout__review" *ngIf="showReviewView$ | async">
    <checkout-cart-async-wrapper class="checkout__mobile-review" [cartTitle]="'Review Order'" [cart]="CartContainer.cart$ | async" [loading]="CartContainer.loading$ | async">
      <place-order></place-order>
    </checkout-cart-async-wrapper>
  </div>
  <div *ngIf="(CartContainer.loading$ | async)" class="checkout__loading-icon">
    <i class="fa fa-spinner fa-spin fa-5x"></i>
  </div>
</div>
